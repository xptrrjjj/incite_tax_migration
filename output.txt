(incite_venv) PS C:\Users\lunaf\Desktop\Projects\simplyautomate\incite_migration_script> python extract_pdf_editor.py
âœ“ Using configuration from config.py
PDF Editor Extraction & Analysis
==================================================
2025-08-29 21:03:30,247 - INFO - âœ“ Successfully authenticated with Salesforce
2025-08-29 21:03:30,247 - INFO - ðŸ” Starting comprehensive PDF Editor extraction...
2025-08-29 21:03:30,248 - INFO - ðŸ“¦ Downloading TL_PDF_Editor static resource...
2025-08-29 21:03:31,138 - INFO - âœ“ Found resource: 081UU0000000YePYAU (2101754 bytes)
2025-08-29 21:03:33,185 - INFO - âœ… Downloaded 2101754 bytes
2025-08-29 21:03:33,185 - INFO - ðŸ“¦ Extracting ZIP content...
2025-08-29 21:03:33,187 - INFO - âœ“ Found 8 files in ZIP
2025-08-29 21:03:33,197 - INFO - âœ“ Extracted text file: assets/index-29JfJxHM.js (1627666 chars)
2025-08-29 21:03:33,198 - INFO - âœ“ Extracted text file: assets/index-BpGgzq9K.css (4533 chars)
2025-08-29 21:03:33,201 - INFO - âœ“ Extracted text file: index.html (1218856 chars)
2025-08-29 21:03:33,207 - INFO - âœ“ Extracted text file: pdf.worker.js (2236524 chars)
2025-08-29 21:03:33,209 - INFO - ðŸ” Analyzing extracted files for S3 patterns...
2025-08-29 21:03:33,210 - INFO - ðŸ” Analyzing: assets/index-29JfJxHM.js
2025-08-29 21:03:33,659 - INFO - ðŸ” Analyzing: assets/index-BpGgzq9K.css
2025-08-29 21:03:33,661 - INFO - ðŸ” Analyzing: index.html
2025-08-29 21:03:33,927 - INFO - ðŸ” Analyzing: pdf.worker.js
2025-08-29 21:03:37,775 - INFO - ðŸ” Testing iframe access...
2025-08-29 21:03:37,775 - INFO - Testing: https://incitetax.my.salesforce.com/resource/1748037284000/TL_PDF_Editor/index.html
2025-08-29 21:03:40,354 - INFO - âœ… Successfully accessed HTML content
2025-08-29 21:03:40,354 - INFO - Testing: https://incitetax.my.salesforce.com/resource/TL_PDF_Editor/index.html
2025-08-29 21:03:42,670 - INFO - âœ… Successfully accessed HTML content
2025-08-29 21:03:42,670 - INFO - Testing: https://incitetax.my.salesforce.com/resource/1748037284000/TL_PDF_Editor
2025-08-29 21:03:45,058 - INFO - âœ… Successfully accessed HTML content
2025-08-29 21:03:45,058 - INFO - Testing: https://incitetax.my.salesforce.com/resource/TL_PDF_Editor
2025-08-29 21:03:47,403 - INFO - âœ… Successfully accessed HTML content

================================================================================
TL_PDF_EDITOR EXTRACTION & ANALYSIS
================================================================================
âœ… Extraction Success: 8 files extracted
ðŸ“„ Text files: 4
ðŸ“¦ Binary files: 4

ðŸ”‘ Key files found:
  â€¢ index.html (1218856 chars)

ðŸ” ANALYSIS RESULTS
--------------------------------------------------
ðŸŒ S3 patterns found: 2
ðŸ“ž API patterns found: 522
ðŸ” Auth patterns found: 6

ðŸŒ S3 PATTERNS:
  ðŸ“ assets/index-29JfJxHM.js: presigned-url`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({identifier:i,app:"pdf-editor-sf",action:"save-new-version"})}).then(y=>y.json());console.log(p),h=(c=p==null?void 0:p.data)==null?void 0:c.url;const g=new File([s],"upload.pdf",{type:"application/pdf"}),w=await fetch(h,{method:"PUT",body:g,headers:{"Content-Type":"application/pdf"}}),b=await fetch(`https://${o}/api/document/versions/${i}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}}).then(y=>y.json());console.log(w),window.parent.postMessage({message:{sender:"PdfEditor",query:"saveNewVersion",data:{annotations:[...l,...u],pdfUrl:(f=h==null?void 0:h.split("?"))==null?void 0:f.at(0),versionId:(d=b==null?void 0:b.data)==null?void 0:d.latestVersion}}},"*")}catch(p){console.error(p)}return!0}catch(h){return console.error(h),{}}}var PH={exports:{}};function wye(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var k5={exports:{}};const Cye={},fg=Object.freeze(Object.defineProperty({__proto__:null,default:Cye},Symbol.toStringTag,{value:"Module"})),Sye=w_(fg);var vD;function It(){return vD||(vD=1,function(t,e){(function(r,n){t.exports=n()})(Fe,function(){var r=r||function(n,i){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Fe<"u"&&Fe.crypto&&(o=Fe.crypto),!o&&typeof wye=="function")try{o=Sye}catch{}var a=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function y(){}return function(x){var C;return y.prototype=x,C=new y,y.prototype=null,C}}(),l={},u=l.lib={},c=u.Base=function(){return{extend:function(y){var x=s(this);return y&&x.mixIn(y),(!x.hasOwnProperty("init")||this.init===x.init)&&(x.init=function(){x.$super.init.apply(this,arguments)}),x.init.prototype=x,x.$super=this,x},create:function(){var y=this.extend();return y.init.apply(y,arguments),y},init:function(){},mixIn:function(y){for(var x in y)y.hasOwnProperty(x)&&(this[x]=y[x]);y.hasOwnProperty("toString")&&(this.toString=y.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=u.WordArray=c.extend({init:function(y,x){y=this.words=y||[],x!=i?this.sigBytes=x:this.sigBytes=y.length*4},toString:function(y){return(y||h).stringify(this)},concat:function(y){var x=this.words,C=y.words,S=this.sigBytes,_=y.sigBytes;if(this.clamp(),S%4)for(var A=0;A<_;A++){var P=C[A>>>2]>>>24-A%4*8&255;x[S+A>>>2]|=P<<24-(S+A)%4*8}else for(var R=0;R<_;R+=4)x[S+R>>>2]=C[R>>>2];return this.sigBytes+=_,this},clamp:function(){var y=this.words,x=this.sigBytes;y[x>>>2]&=4294967295<<32-x%4*8,y.length=n.ceil(x/4)},clone:function(){var y=c.clone.call(this);return y.words=this.words.slice(0),y},random:function(y){for(var x=[],C=0;C<y;C+=4)x.push(a());return new f.init(x,y)}}),d=l.enc={},h=d.Hex={stringify:function(y){for(var x=y.words,C=y.sigBytes,S=[],_=0;_<C;_++){var A=x[_>>>2]>>>24-_%4*8&255;S.push((A>>>4).toString(16)),S.push((A&15).toString(16))}return S.join("")},parse:function(y){for(var x=y.length,C=[],S=0;S<x;S+=2)C[S>>>3]|=parseInt(y.substr(S,2),16)<<24-S%8*4;return new f.init(C,x/2)}},p=d.Latin1={stringify:function(y){for(var x=y.words,C=y.sigBytes,S=[],_=0;_<C;_++){var A=x[_>>>2]>>>24-_%4*8&255;S.push(String.fromCharCode(A))}return S.join("")},parse:function(y){for(var x=y.length,C=[],S=0;S<x;S++)C[S>>>2]|=(y.charCodeAt(S)&255)<<24-S%4*8;return new f.init(C,x)}},g=d.Utf8={stringify:function(y){try{return decodeURIComponent(escape(p.stringify(y)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(y){return p.parse(unescape(encodeURIComponent(y)))}},w=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(y){typeof y=="string"&&(y=g.parse(y)),this._data.concat(y),this._nDataBytes+=y.sigBytes},_process:function(y){var x,C=this._data,S=C.words,_=C.sigBytes,A=this.blockSize,P=A*4,R=_/P;y?R=n.ceil(R):R=n.max((R|0)-this._minBufferSize,0);var T=R*A,k=n.min(T*4,_);if(T){for(var B=0;B<T;B+=A)this._doProcessBlock(S,B);x=S.splice(0,T),C.sigBytes-=k}return new f.init(x,k)},clone:function(){var y=c.clone.call(this);return y._data=this._data.clone(),y},_minBufferSize:0});u.Hasher=w.extend({cfg:c.extend(),init:function(y){this.cfg=this.cfg.extend(y),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(y){return this._append(y),this._process(),this},finalize:function(y){y&&this._append(y);var x=this._doFinalize();return x},blockSize:16,_createHelper:function(y){return function(x,C){return new y.init(C).finalize(x)}},_createHmacHelper:function(y){return function(x,C){return new b.HMAC.init(y,C).finalize(x)}}});var b=l.algo={};return l}(Math);return r})}(k5)),k5.exports}var D5={exports:{}},gD;function o4(){return gD||(gD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(n){var i=r,o=i.lib,a=o.Base,s=o.WordArray,l=i.x64={};l.Word=a.extend({init:function(u,c){this.high=u,this.low=c}}),l.WordArray=a.extend({init:function(u,c){u=this.words=u||[],c!=n?this.sigBytes=c:this.sigBytes=u.length*8},toX32:function(){for(var u=this.words,c=u.length,f=[],d=0;d<c;d++){var h=u[d];f.push(h.high),f.push(h.low)}return s.create(f,this.sigBytes)},clone:function(){for(var u=a.clone.call(this),c=u.words=this.words.slice(0),f=c.length,d=0;d<f;d++)c[d]=c[d].clone();return u}})}(),r})}(D5)),D5.exports}var R5={exports:{}},mD;function Eye(){return mD||(mD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(){if(typeof ArrayBuffer=="function"){var n=r,i=n.lib,o=i.WordArray,a=o.init,s=o.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var u=l.byteLength,c=[],f=0;f<u;f++)c[f>>>2]|=l[f]<<24-f%4*8;a.call(this,c,u)}else a.apply(this,arguments)};s.prototype=o}}(),r.lib.WordArray})}(R5)),R5.exports}var F5={exports:{}},yD;function _ye(){return yD||(yD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.WordArray,a=n.enc;a.Utf16=a.Utf16BE={stringify:function(l){for(var u=l.words,c=l.sigBytes,f=[],d=0;d<c;d+=2){var h=u[d>>>2]>>>16-d%4*8&65535;f.push(String.fromCharCode(h))}return f.join("")},parse:function(l){for(var u=l.length,c=[],f=0;f<u;f++)c[f>>>1]|=l.charCodeAt(f)<<16-f%2*16;return o.create(c,u*2)}},a.Utf16LE={stringify:function(l){for(var u=l.words,c=l.sigBytes,f=[],d=0;d<c;d+=2){var h=s(u[d>>>2]>>>16-d%4*8&65535);f.push(String.fromCharCode(h))}return f.join("")},parse:function(l){for(var u=l.length,c=[],f=0;f<u;f++)c[f>>>1]|=s(l.charCodeAt(f)<<16-f%2*16);return o.create(c,u*2)}};function s(l){return l<<8&4278255360|l>>>8&16711935}}(),r.enc.Utf16})}(F5)),F5.exports}var I5={exports:{}},bD;function kh(){return bD||(bD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.WordArray,a=n.enc;a.Base64={stringify:function(l){var u=l.words,c=l.sigBytes,f=this._map;l.clamp();for(var d=[],h=0;h<c;h+=3)for(var p=u[h>>>2]>>>24-h%4*8&255,g=u[h+1>>>2]>>>24-(h+1)%4*8&255,w=u[h+2>>>2]>>>24-(h+2)%4*8&255,b=p<<16|g<<8|w,y=0;y<4&&h+y*.75<c;y++)d.push(f.charAt(b>>>6*(3-y)&63));var x=f.charAt(64);if(x)for(;d.length%4;)d.push(x);return d.join("")},parse:function(l){var u=l.length,c=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var d=0;d<c.length;d++)f[c.charCodeAt(d)]=d}var h=c.charAt(64);if(h){var p=l.indexOf(h);p!==-1&&(u=p)}return s(l,u,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function s(l,u,c){for(var f=[],d=0,h=0;h<u;h++)if(h%4){var p=c[l.charCodeAt(h-1)]<<h%4*2,g=c[l.charCodeAt(h)]>>>6-h%4*2,w=p|g;f[d>>>2]|=w<<24-d%4*8,d++}return o.create(f,d)}}(),r.enc.Base64})}(I5)),I5.exports}var M5={exports:{}},xD;function Aye(){return xD||(xD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.WordArray,a=n.enc;a.Base64url={stringify:function(l,u){u===void 0&&(u=!0);var c=l.words,f=l.sigBytes,d=u?this._safe_map:this._map;l.clamp();for(var h=[],p=0;p<f;p+=3)for(var g=c[p>>>2]>>>24-p%4*8&255,w=c[p+1>>>2]>>>24-(p+1)%4*8&255,b=c[p+2>>>2]>>>24-(p+2)%4*8&255,y=g<<16|w<<8|b,x=0;x<4&&p+x*.75<f;x++)h.push(d.charAt(y>>>6*(3-x)&63));var C=d.charAt(64);if(C)for(;h.length%4;)h.push(C);return h.join("")},parse:function(l,u){u===void 0&&(u=!0);var c=l.length,f=u?this._safe_map:this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var h=0;h<f.length;h++)d[f.charCodeAt(h)]=h}var p=f.charAt(64);if(p){var g=l.indexOf(p);g!==-1&&(c=g)}return s(l,c,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function s(l,u,c){for(var f=[],d=0,h=0;h<u;h++)if(h%4){var p=c[l.charCodeAt(h-1)]<<h%4*2,g=c[l.charCodeAt(h)]>>>6-h%4*2,w=p|g;f[d>>>2]|=w<<24-d%4*8,d++}return o.create(f,d)}}(),r.enc.Base64url
     Context:
       269   `))==null?void 0:T.sort((j,G)=>(G==null?void 0:G.length)-(j==null?void 0:j.length)))==null?void 0:k.at(0),p.current.style.width=((B=g==null?void 0:g.current)==null?void 0:B.offsetWidth)+"px",A.key==="Enter"&&!A.shiftKey&&t!=null&&t.Id)return T5({close:!0,ctx:n,selectedAnnotation:t,inputCords:y,value:o,dispatch:i})},style:{fontSize:`${(h==null?void 0:h.fontSize)*w}px`,fontFamily:h==null?void 0:h.fontFamily,color:(h==null?void 0:h.color)??"black",backgroundColor:"transparent",resize:"none",overflow:"hidden",width:`${((_=g==null?void 0:g.current)==null?void 0:_.offsetWidth)??10}px`},type:"text"}),E.jsx("div",{style:{opacity:.05,padding:".6em",fontSize:`${(e==null?void 0:e.fontSize)*w}px`,fontFamily:e==null?void 0:e.fontFamily,width:"fit-content"},ref:g,id:"text-size-measure"})]})})},gye=[""," ",`
       270   `,"        ","\r","\f","\v","."],mye=({pdfPage:t={},pdfScale:e}={})=>{var a;const[r,n]=q.useState([]),[i,o]=q.useState({});return q.useEffect(()=>{o(t.getViewport({scale:e}))},[e]),q.useEffect(()=>{async function s(){const l=await t.getTextContent();l.items=l.items.filter(u=>!gye.includes(u.str)),n(l)}s()},[t]),E.jsx("div",{style:{height:"100%",position:"relative"},children:(a=r==null?void 0:r.items)==null?void 0:a.map((s,l)=>{var u,c,f,d,h;return E.jsx("div",{style:{position:"absolute",bottom:-6+((u=s==null?void 0:s.transform)==null?void 0:u.at(5))*e+Math.abs((c=i==null?void 0:i.viewBox)==null?void 0:c.at(0))*e,left:(s==null?void 0:s.transform.at(4))*e+Math.abs((f=i==null?void 0:i.viewBox)==null?void 0:f.at(1))*e,fontSize:(s==null?void 0:s.transform[3])*e,fontFamily:(h=(d=r==null?void 0:r.styles)==null?void 0:d[s.fontName])==null?void 0:h.fontFamily,color:"transparent"},children:s==null?void 0:s.str},l)})})},yye=({page:t,pageIndex:e,setPagesInsideViewport:r})=>{var p,g,w,b,y,x,C,S,_,A,P,R,T,k,B,j,G,Q;const[n,i]=ht(),o=q.useRef(null),a=q.useRef(null),s=q.useRef(null),l=q.useRef(null),u=q.useRef(null),c=q.useRef(null),f=e+1,d=$=>{$.forEach(({isIntersecting:z})=>{r(X=>{const se=[...X],ie=se.indexOf(f);return z&&ie===-1?se.push(f):!z&&ie>-1&&se.splice(ie,1),se})})};function h({showAll:$=!1}={}){var Z,te;const X=n.pdfScale/1.5,se=((Z=n==null?void 0:n.annotations)==null?void 0:Z.at(f-1))??[],ie=(te=s==null?void 0:s.current)==null?void 0:te.getContext("2d");if(!ie)return()=>{};ie.clearRect(0,0,s.current.width,s.current.height),se==null||se.forEach(J=>{var ae,xe,Ae,ve,he,fe,Me,pt,me,Pe;if(!(J!=null&&J.Hidden&&!$)){if((J==null?void 0:J.Type__c)==="Draw"){ie.strokeStyle=((ae=J==null?void 0:J.DrawConfig__c)==null?void 0:ae.strokeStyle)??"#000",ie.lineWidth=((xe=J==null?void 0:J.DrawConfig__c)==null?void 0:xe.lineWidth)*X;const le=(J==null?void 0:J.DrawPoints__c)??[];if(!(le!=null&&le.length)||(Array==null?void 0:Array.isArray(le))===!1)return;le==null||le.forEach((Le,ze)=>{if(ze===0){ie.beginPath(),ie.moveTo(Le.x*X,Le.y*X);return}ie.lineTo(Le.x*X,Le.y*X),ie.stroke()})}if(J.Type__c==="Annotation"){const le=window.URL||window.webkitURL||window,Le=new Image,ze=new Blob([J==null?void 0:J.SvgData__c],{type:"image/svg+xml"}),Lt=le.createObjectURL(ze);Le.onload=function(){ie.drawImage(Le,J.PositionX__c*X,J.PositionY__c*X,25*X,25*X),le.revokeObjectURL(Lt)},Le.src=Lt}if(J.Type__c==="Text"){const Le=s.current.getContext("2d"),ze=(Ae=J==null?void 0:J.Content__c)==null?void 0:Ae.split(`
       271 â†’ `);Le.font=`${((ve=J.TextConfig__c)==null?void 0:ve.fontSize)*X}px ${(he=J.TextConfig__c)==null?void 0:he.fontFamily}`,Le.fillStyle=((fe=J==null?void 0:J.TextConfig__c)==null?void 0:fe.color)??((Me=n==null?void 0:n.textConfig)==null?void 0:Me.color)??"#000",ze!=null&&ze.length&&(ze==null||ze.map((Lt,ye)=>{var Kt;Le.fillText(Lt,J.PositionX__c*X,J.PositionY__c*X+5+ye*((Kt=J.TextConfig__c)==null?void 0:Kt.fontSize))}))}(J.Type__c==="Rectangle"||J.Type__c==="Highlight")&&(ie.strokeStyle=((pt=J==null?void 0:J.DrawConfig__c)==null?void 0:pt.strokeStyle)??"#000",ie.lineWidth=((me=J==null?void 0:J.DrawConfig__c)==null?void 0:me.lineWidth)*X,ie.beginPath(),J.Type__c==="Highlight"?(ie.fillStyle=((Pe=J==null?void 0:J.DrawConfig__c)==null?void 0:Pe.strokeStyle)+"33",ie.fillRect(J.PositionX__c*X,J.PositionY__c*X,J.DrawConfig__c.width*X,J.DrawConfig__c.height*X)):ie.rect(J.PositionX__c*X,J.PositionY__c*X,J.DrawConfig__c.width*X,J.DrawConfig__c.height*X),ie.stroke())}}),$&&i(J=>({...J,showAllAnnotations:!1}))}return q.useEffect(()=>{let $=null;if((u==null?void 0:u.current)===(n==null?void 0:n.pdfScale))return()=>{};(async()=>{l.current=f;const ie=n.pdfScale,Z=t.getViewport({scale:ie}),te=a.current,J=te.getContext("2d");te.height=Z.height,te.width=Z.width,o.current.style.width=Z.width+"px",o.current.style.height=Z.height+"px";const ae={canvasContext:J,viewport:Z};$=t.render(ae),$.promise.then(()=>{var xe;f<n.windowFocusedPage+3&&setTimeout(()=>{h()},100),f===((xe=n==null?void 0:n.pdfPages)==null?void 0:xe.length)&&i(Ae=>({...Ae,renderedAllPages:Math.random()}))})})();let X=new IntersectionObserver(d,{threshold:.3}),se=document.getElementById(`render-canvas-${f}`);return se&&X.observe(se),c.current=!1,()=>{$==null||$.cancel(),X.unobserve(se)}},[t,n.pdfScale,n==null?void 0:n.windowFocusedPage]),q.useEffect(()=>(h({showAll:(n==null?void 0:n.showAllAnnotations)??!1}),()=>{}),[n==null?void 0:n.repaintAnnotations]),q.useEffect(()=>{f<n.windowFocusedPage+3&&!c.current&&(console.log(`RENDERING ANNOTATIONS PAGE: ${f}`),h(),c.current=!0)},[n==null?void 0:n.windowFocusedPage,n==null?void 0:n.renderedAllPages]),E.jsx("div",{ref:o,children:E.jsxs("div",{style:{position:"relative",marginTop:"2em",height:"100%"},children:[E.jsxs(E.Fragment,{children:[E.jsx("div",{style:{width:(p=a.current)==null?void 0:p.width,height:(g=a.current)==null?void 0:g.height,position:"absolute"},id:`comments-${f}`}),E.jsx(oye,{ctx:n,dispatch:i,pageNumber:f,comments:((b=(w=n==null?void 0:n.comments)==null?void 0:w.at(e))==null?void 0:b.filter($=>$==null?void 0:$.Main__c))??[]})]}),E.jsx("canvas",{id:`render-canvas-${f}`,style:{position:"absolute"},ref:a,"data-page":f}),E.jsx("canvas",{id:`draw-canvas-${f}`,onClick:$=>{n.activeMode!=="hand"&&i(z=>({...z,drawCanvasClick:z.disableClick?null:$,disableClick:!1}))},height:(y=a.current)==null?void 0:y.height,width:(x=a.current)==null?void 0:x.width,style:{width:(C=a.current)==null?void 0:C.width,height:(S=a.current)==null?void 0:S.height,position:"absolute"},ref:s,"data-page":f}),n.activeMode==="rectangle"&&E.jsx(fye,{height:(_=a.current)==null?void 0:_.height,width:(A=a.current)==null?void 0:A.width,dispatch:i,pageNumber:f,allAnnotations:n==null?void 0:n.annotations,pdfScale:n.pdfScale,drawConfig:n.drawConfig}),n.activeMode==="highlight"&&E.jsx(hye,{height:(P=a.current)==null?void 0:P.height,width:(R=a.current)==null?void 0:R.width,dispatch:i,pageNumber:f,allAnnotations:n==null?void 0:n.annotations,pdfScale:n.pdfScale,drawConfig:n.highlightConfig}),((T=n==null?void 0:n.selectedAnnotation)==null?void 0:T.Id)&&((k=n==null?void 0:n.selectedAnnotation)==null?void 0:k.Page__c)===f&&E.jsx(uye,{ctx:n,dispatch:i}),n.activeMode==="hand"&&E.jsx(pye,{height:(B=a.current)==null?void 0:B.height,width:(j=a.current)==null?void 0:j.width,dispatch:i,pageNumber:f,allAnnotations:n==null?void 0:n.annotations,pdfScale:n.pdfScale}),n.activeMode==="text"&&((G=n==null?void 0:n.selectedAnnotation)==null?void 0:G.Page__c)===f&&((Q=n.selectedAnnotation)==null?void 0:Q.Type__c)==="Text"&&E.jsx(vye,{pageNumber:f,selectedAnnotation:n.selectedAnnotation,textConfig:n==null?void 0:n.textConfig,pdfScale:n.pdfScale}),!(n!=null&&n.activeMode)&&E.jsx(mye,{pdfPage:t,pdfScale:n.pdfScale})]})})},bye=({ctx:t,dispatch:e})=>{var n,i,o;const r=Bo(t==null?void 0:t.createAnnotation);return r&&(r.LoggedUser__c=((i=(n=t==null?void 0:t.sfData)==null?void 0:n.loggedUser)==null?void 0:i.Name)??"No User"),q.useEffect(()=>{var a,s,l,u;if(((a=t==null?void 0:t.updateAnnotation)==null?void 0:a.length)===0||!(t!=null&&t.updateAnnotation))return()=>{};console.log("updating",t==null?void 0:t.updateAnnotation),window.parent.postMessage({message:{sender:"PdfEditor",action:"annotation-update",data:{docListEntry:(s=t==null?void 0:t.sfData)==null?void 0:s.docListEntry,annotations:(u=(l=t==null?void 0:t.updateAnnotation)==null?void 0:l.map(c=>E1(c,["CreatedDate","LastModifiedDate","attributes","SystemModstamp","LastModifiedById","CreatedById","OwnerId"])).filter(c=>!(c.Type__c==="Rectangle"&&typeof(c==null?void 0:c.PositionX__c)!="number"&&typeof(c==null?void 0:c.PositionY__c)!="number")))==null?void 0:u.map(c=>({...c,PositionX__c:Number(c==null?void 0:c.PositionX__c)??0,PositionY__c:Number(c==null?void 0:c.PositionY__c)??0}))}}},"*"),e(c=>({...c,updateAnnotation:[]}))},[t==null?void 0:t.updateAnnotation]),q.useEffect(()=>{var a,s;if(!((a=t==null?void 0:t.createAnnotation)!=null&&a.Id))return()=>{};window.parent.postMessage({message:{sender:"PdfEditor",action:"annotation-create",data:{docListEntry:(s=t==null?void 0:t.sfData)==null?void 0:s.docListEntry,annotation:{...E1({...r,PositionX__c:Number(r==null?void 0:r.PositionX__c)??0,PositionY__c:Number(r==null?void 0:r.PositionY__c)??0},["CreatedDate","Id"])}}}},"*")},[(o=t==null?void 0:t.createAnnotation)==null?void 0:o.Id]),E.jsx(E.Fragment,{})};async function xye({bytes:t,annotations:e=[],comments:r=[],authToken:n,Identifier__c:i,orgUrl:o}){var c,f,d;if(!t)return;window.parent.postMessage({message:{sender:"PdfEditor",query:"document-save-start",data:{}}},"*"),console.log("Saving new version");const a=["Id","Hidden","LastModifiedDate","LastModifiedBy","LastModifiedById","CreatedDate","CreatedBy","CreatedById","SystemModstamp","OwnerId"],s=new Blob([t],{type:"application/pdf"});let l=e==null?void 0:e.reduce((h,p)=>[...h,...p??[]],[]);l=l.map(h=>E1(h,a));let u=r==null?void 0:r.reduce((h,p)=>[...h,...p??[]],[]);u=u.map(h=>E1(h,a));try{let h;try{const p=await fetch(`https://${o}/api/generate/presigned-url`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({identifier:i,app:"pdf-editor-sf",action:"save-new-version"})}).then(y=>y.json());console.log(p),h=(c=p==null?void 0:p.data)==null?void 0:c.url;const g=new File([s],"upload.pdf",{type:"application/pdf"}),w=await fetch(h,{method:"PUT",body:g,headers:{"Content-Type":"application/pdf"}}),b=await fetch(`https://${o}/api/document/versions/${i}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}}).then(y=>y.json());console.log(w),window.parent.postMessage({message:{sender:"PdfEditor",query:"saveNewVersion",data:{annotations:[...l,...u],pdfUrl:(f=h==null?void 0:h.split("?"))==null?void 0:f.at(0),versionId:(d=b==null?void 0:b.data)==null?void 0:d.latestVersion}}},"*")}catch(p){console.error(p)}return!0}catch(h){return console.error(h),{}}}var PH={exports:{}};function wye(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var k5={exports:{}};const Cye={},fg=Object.freeze(Object.defineProperty({__proto__:null,default:Cye},Symbol.toStringTag,{value:"Module"})),Sye=w_(fg);var vD;function It(){return vD||(vD=1,function(t,e){(function(r,n){t.exports=n()})(Fe,function(){var r=r||function(n,i){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Fe<"u"&&Fe.crypto&&(o=Fe.crypto),!o&&typeof wye=="function")try{o=Sye}catch{}var a=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function y(){}return function(x){var C;return y.prototype=x,C=new y,y.prototype=null,C}}(),l={},u=l.lib={},c=u.Base=function(){return{extend:function(y){var x=s(this);return y&&x.mixIn(y),(!x.hasOwnProperty("init")||this.init===x.init)&&(x.init=function(){x.$super.init.apply(this,arguments)}),x.init.prototype=x,x.$super=this,x},create:function(){var y=this.extend();return y.init.apply(y,arguments),y},init:function(){},mixIn:function(y){for(var x in y)y.hasOwnProperty(x)&&(this[x]=y[x]);y.hasOwnProperty("toString")&&(this.toString=y.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=u.WordArray=c.extend({init:function(y,x){y=this.words=y||[],x!=i?this.sigBytes=x:this.sigBytes=y.length*4},toString:function(y){return(y||h).stringify(this)},concat:function(y){var x=this.words,C=y.words,S=this.sigBytes,_=y.sigBytes;if(this.clamp(),S%4)for(var A=0;A<_;A++){var P=C[A>>>2]>>>24-A%4*8&255;x[S+A>>>2]|=P<<24-(S+A)%4*8}else for(var R=0;R<_;R+=4)x[S+R>>>2]=C[R>>>2];return this.sigBytes+=_,this},clamp:function(){var y=this.words,x=this.sigBytes;y[x>>>2]&=4294967295<<32-x%4*8,y.length=n.ceil(x/4)},clone:function(){var y=c.clone.call(this);return y.words=this.words.slice(0),y},random:function(y){for(var x=[],C=0;C<y;C+=4)x.push(a());return new f.init(x,y)}}),d=l.enc={},h=d.Hex={stringify:function(y){for(var x=y.words,C=y.sigBytes,S=[],_=0;_<C;_++){var A=x[_>>>2]>>>24-_%4*8&255;S.push((A>>>4).toString(16)),S.push((A&15).toString(16))}return S.join("")},parse:function(y){for(var x=y.length,C=[],S=0;S<x;S+=2)C[S>>>3]|=parseInt(y.substr(S,2),16)<<24-S%8*4;return new f.init(C,x/2)}},p=d.Latin1={stringify:function(y){for(var x=y.words,C=y.sigBytes,S=[],_=0;_<C;_++){var A=x[_>>>2]>>>24-_%4*8&255;S.push(String.fromCharCode(A))}return S.join("")},parse:function(y){for(var x=y.length,C=[],S=0;S<x;S++)C[S>>>2]|=(y.charCodeAt(S)&255)<<24-S%4*8;return new f.init(C,x)}},g=d.Utf8={stringify:function(y){try{return decodeURIComponent(escape(p.stringify(y)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(y){return p.parse(unescape(encodeURIComponent(y)))}},w=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(y){typeof y=="string"&&(y=g.parse(y)),this._data.concat(y),this._nDataBytes+=y.sigBytes},_process:function(y){var x,C=this._data,S=C.words,_=C.sigBytes,A=this.blockSize,P=A*4,R=_/P;y?R=n.ceil(R):R=n.max((R|0)-this._minBufferSize,0);var T=R*A,k=n.min(T*4,_);if(T){for(var B=0;B<T;B+=A)this._doProcessBlock(S,B);x=S.splice(0,T),C.sigBytes-=k}return new f.init(x,k)},clone:function(){var y=c.clone.call(this);return y._data=this._data.clone(),y},_minBufferSize:0});u.Hasher=w.extend({cfg:c.extend(),init:function(y){this.cfg=this.cfg.extend(y),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(y){return this._append(y),this._process(),this},finalize:function(y){y&&this._append(y);var x=this._doFinalize();return x},blockSize:16,_createHelper:function(y){return function(x,C){return new y.init(C).finalize(x)}},_createHmacHelper:function(y){return function(x,C){return new b.HMAC.init(y,C).finalize(x)}}});var b=l.algo={};return l}(Math);return r})}(k5)),k5.exports}var D5={exports:{}},gD;function o4(){return gD||(gD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(n){var i=r,o=i.lib,a=o.Base,s=o.WordArray,l=i.x64={};l.Word=a.extend({init:function(u,c){this.high=u,this.low=c}}),l.WordArray=a.extend({init:function(u,c){u=this.words=u||[],c!=n?this.sigBytes=c:this.sigBytes=u.length*8},toX32:function(){for(var u=this.words,c=u.length,f=[],d=0;d<c;d++){var h=u[d];f.push(h.high),f.push(h.low)}return s.create(f,this.sigBytes)},clone:function(){for(var u=a.clone.call(this),c=u.words=this.words.slice(0),f=c.length,d=0;d<f;d++)c[d]=c[d].clone();return u}})}(),r})}(D5)),D5.exports}var R5={exports:{}},mD;function Eye(){return mD||(mD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(){if(typeof ArrayBuffer=="function"){var n=r,i=n.lib,o=i.WordArray,a=o.init,s=o.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var u=l.byteLength,c=[],f=0;f<u;f++)c[f>>>2]|=l[f]<<24-f%4*8;a.call(this,c,u)}else a.apply(this,arguments)};s.prototype=o}}(),r.lib.WordArray})}(R5)),R5.exports}var F5={exports:{}},yD;function _ye(){return yD||(yD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.WordArray,a=n.enc;a.Utf16=a.Utf16BE={stringify:function(l){for(var u=l.words,c=l.sigBytes,f=[],d=0;d<c;d+=2){var h=u[d>>>2]>>>16-d%4*8&65535;f.push(String.fromCharCode(h))}return f.join("")},parse:function(l){for(var u=l.length,c=[],f=0;f<u;f++)c[f>>>1]|=l.charCodeAt(f)<<16-f%2*16;return o.create(c,u*2)}},a.Utf16LE={stringify:function(l){for(var u=l.words,c=l.sigBytes,f=[],d=0;d<c;d+=2){var h=s(u[d>>>2]>>>16-d%4*8&65535);f.push(String.fromCharCode(h))}return f.join("")},parse:function(l){for(var u=l.length,c=[],f=0;f<u;f++)c[f>>>1]|=s(l.charCodeAt(f)<<16-f%2*16);return o.create(c,u*2)}};function s(l){return l<<8&4278255360|l>>>8&16711935}}(),r.enc.Utf16})}(F5)),F5.exports}var I5={exports:{}},bD;function kh(){return bD||(bD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.WordArray,a=n.enc;a.Base64={stringify:function(l){var u=l.words,c=l.sigBytes,f=this._map;l.clamp();for(var d=[],h=0;h<c;h+=3)for(var p=u[h>>>2]>>>24-h%4*8&255,g=u[h+1>>>2]>>>24-(h+1)%4*8&255,w=u[h+2>>>2]>>>24-(h+2)%4*8&255,b=p<<16|g<<8|w,y=0;y<4&&h+y*.75<c;y++)d.push(f.charAt(b>>>6*(3-y)&63));var x=f.charAt(64);if(x)for(;d.length%4;)d.push(x);return d.join("")},parse:function(l){var u=l.length,c=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var d=0;d<c.length;d++)f[c.charCodeAt(d)]=d}var h=c.charAt(64);if(h){var p=l.indexOf(h);p!==-1&&(u=p)}return s(l,u,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function s(l,u,c){for(var f=[],d=0,h=0;h<u;h++)if(h%4){var p=c[l.charCodeAt(h-1)]<<h%4*2,g=c[l.charCodeAt(h)]>>>6-h%4*2,w=p|g;f[d>>>2]|=w<<24-d%4*8,d++}return o.create(f,d)}}(),r.enc.Base64})}(I5)),I5.exports}var M5={exports:{}},xD;function Aye(){return xD||(xD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.WordArray,a=n.enc;a.Base64url={stringify:function(l,u){u===void 0&&(u=!0);var c=l.words,f=l.sigBytes,d=u?this._safe_map:this._map;l.clamp();for(var h=[],p=0;p<f;p+=3)for(var g=c[p>>>2]>>>24-p%4*8&255,w=c[p+1>>>2]>>>24-(p+1)%4*8&255,b=c[p+2>>>2]>>>24-(p+2)%4*8&255,y=g<<16|w<<8|b,x=0;x<4&&p+x*.75<f;x++)h.push(d.charAt(y>>>6*(3-x)&63));var C=d.charAt(64);if(C)for(;h.length%4;)h.push(C);return h.join("")},parse:function(l,u){u===void 0&&(u=!0);var c=l.length,f=u?this._safe_map:this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var h=0;h<f.length;h++)d[f.charCodeAt(h)]=h}var p=f.charAt(64);if(p){var g=l.indexOf(p);g!==-1&&(c=g)}return s(l,c,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function s(l,u,c){for(var f=[],d=0,h=0;h<u;h++)if(h%4){var p=c[l.charCodeAt(h-1)]<<h%4*2,g=c[l.charCodeAt(h)]>>>6-h%4*2,w=p|g;f[d>>>2]|=w<<24-d%4*8,d++}return o.create(f,d)}}(),r.enc.Base64url})}(M5)),M5.exports}var N5={exports:{}},wD;function Dh(){return wD||(wD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(n){var i=r,o=i.lib,a=o.WordArray,s=o.Hasher,l=i.algo,u=[];(function(){for(var g=0;g<64;g++)u[g]=n.abs(n.sin(g+1))*4294967296|0})();var c=l.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,w){for(var b=0;b<16;b++){var y=w+b,x=g[y];g[y]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360}var C=this._hash.words,S=g[w+0],_=g[w+1],A=g[w+2],P=g[w+3],R=g[w+4],T=g[w+5],k=g[w+6],B=g[w+7],j=g[w+8],G=g[w+9],Q=g[w+10],$=g[w+11],z=g[w+12],X=g[w+13],se=g[w+14],ie=g[w+15],Z=C[0],te=C[1],J=C[2],ae=C[3];Z=f(Z,te,J,ae,S,7,u[0]),ae=f(ae,Z,te,J,_,12,u[1]),J=f(J,ae,Z,te,A,17,u[2]),te=f(te,J,ae,Z,P,22,u[3]),Z=f(Z,te,J,ae,R,7,u[4]),ae=f(ae,Z,te,J,T,12,u[5]),J=f(J,ae,Z,te,k,17,u[6]),te=f(te,J,ae,Z,B,22,u[7]),Z=f(Z,te,J,ae,j,7,u[8]),ae=f(ae,Z,te,J,G,12,u[9]),J=f(J,ae,Z,te,Q,17,u[10]),te=f(te,J,ae,Z,$,22,u[11]),Z=f(Z,te,J,ae,z,7,u[12]),ae=f(ae,Z,te,J,X,12,u[13]),J=f(J,ae,Z,te,se,17,u[14]),te=f(te,J,ae,Z,ie,22,u[15]),Z=d(Z,te,J,ae,_,5,u[16]),ae=d(ae,Z,te,J,k,9,u[17]),J=d(J,ae,Z,te,$,14,u[18]),te=d(te,J,ae,Z,S,20,u[19]),Z=d(Z,te,J,ae,T,5,u[20]),ae=d(ae,Z,te,J,Q,9,u[21]),J=d(J,ae,Z,te,ie,14,u[22]),te=d(te,J,ae,Z,R,20,u[23]),Z=d(Z,te,J,ae,G,5,u[24]),ae=d(ae,Z,te,J,se,9,u[25]),J=d(J,ae,Z,te,P,14,u[26]),te=d(te,J,ae,Z,j,20,u[27]),Z=d(Z,te,J,ae,X,5,u[28]),ae=d(ae,Z,te,J,A,9,u[29]),J=d(J,ae,Z,te,B,14,u[30]),te=d(te,J,ae,Z,z,20,u[31]),Z=h(Z,te,J,ae,T,4,u[32]),ae=h(ae,Z,te,J,j,11,u[33]),J=h(J,ae,Z,te,$,16,u[34]),te=h(te,J,ae,Z,se,23,u[35]),Z=h(Z,te,J,ae,_,4,u[36]),ae=h(ae,Z,te,J,R,11,u[37]),J=h(J,ae,Z,te,B,16,u[38]),te=h(te,J,ae,Z,Q,23,u[39]),Z=h(Z,te,J,ae,X,4,u[40]),ae=h(ae,Z,te,J,S,11,u[41]),J=h(J,ae,Z,te,P,16,u[42]),te=h(te,J,ae,Z,k,23,u[43]),Z=h(Z,te,J,ae,G,4,u[44]),ae=h(ae,Z,te,J,z,11,u[45]),J=h(J,ae,Z,te,ie,16,u[46]),te=h(te,J,ae,Z,A,23,u[47]),Z=p(Z,te,J,ae,S,6,u[48]),ae=p(ae,Z,te,J,B,10,u[49]),J=p(J,ae,Z,te,se,15,u[50]),te=p(te,J,ae,Z,T,21,u[51]),Z=p(Z,te,J,ae,z,6,u[52]),ae=p(ae,Z,te,J,P,10,u[53]),J=p(J,ae,Z,te,Q,15,u[54]),te=p(te,J,ae,Z,_,21,u[55]),Z=p(Z,te,J,ae,j,6,u[56]),ae=p(ae,Z,te,J,ie,10,u[57]),J=p(J,ae,Z,te,k,15,u[58]),te=p(te,J,ae,Z,X,21,u[59]),Z=p(Z,te,J,ae,R,6,u[60]),ae=p(ae,Z,te,J,$,10,u[61]),J=p(J,ae,Z,te,A,15,u[62]),te=p(te,J,ae,Z,G,21,u[63]),C[0]=C[0]+Z|0,C[1]=C[1]+te|0,C[2]=C[2]+J|0,C[3]=C[3]+ae|0},_doFinalize:function(){var g=this._data,w=g.words,b=this._nDataBytes*8,y=g.sigBytes*8;w[y>>>5]|=128<<24-y%32;var x=n.floor(b/4294967296),C=b;w[(y+64>>>9<<4)+15]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,w[(y+64>>>9<<4)+14]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,g.sigBytes=(w.length+1)*4,this._process();for(var S=this._hash,_=S.words,A=0;A<4;A++){var P=_[A];_[A]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return S},clone:function(){var g=s.clone.call(this);return g._hash=this._hash.clone(),g}});function f(g,w,b,y,x,C,S){var _=g+(w&b|~w&y)+x+S;return(_<<C|_>>>32-C)+w}function d(g,w,b,y,x,C,S){var _=g+(w&y|b&~y)+x+S;return(_<<C|_>>>32-C)+w}function h(g,w,b,y,x,C,S){var _=g+(w^b^y)+x+S;return(_<<C|_>>>32-C)+w}function p(g,w,b,y,x,C,S){var _=g+(b^(w|~y))+x+S;return(_<<C|_>>>32-C)+w}i.MD5=s._createHelper(c),i.HmacMD5=s._createHmacHelper(c)}(Math),r.MD5})}(N5)),N5.exports}var L5={exports:{}},CD;function TH(){return CD||(CD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.WordArray,a=i.Hasher,s=n.algo,l=[],u=s.SHA1=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,f){for(var d=this._hash.words,h=d[0],p=d[1],g=d[2],w=d[3],b=d[4],y=0;y<80;y++){if(y<16)l[y]=c[f+y]|0;else{var x=l[y-3]^l[y-8]^l[y-14]^l[y-16];l[y]=x<<1|x>>>31}var C=(h<<5|h>>>27)+b+l[y];y<20?C+=(p&g|~p&w)+1518500249:y<40?C+=(p^g^w)+1859775393:y<60?C+=(p&g|p&w|g&w)-1894007588:C+=(p^g^w)-899497514,b=w,w=g,g=p<<30|p>>>2,p=h,h=C}d[0]=d[0]+h|0,d[1]=d[1]+p|0,d[2]=d[2]+g|0,d[3]=d[3]+w|0,d[4]=d[4]+b|0},_doFinalize:function(){var c=this._data,f=c.words,d=this._nDataBytes*8,h=c.sigBytes*8;return f[h>>>5]|=128<<24-h%32,f[(h+64>>>9<<4)+14]=Math.floor(d/4294967296),f[(h+64>>>9<<4)+15]=d,c.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var c=a.clone.call(this);return c._hash=this._hash.clone(),c}});n.SHA1=a._createHelper(u),n.HmacSHA1=a._createHmacHelper(u)}(),r.SHA1})}(L5)),L5.exports}var B5={exports:{}},SD;function N7(){return SD||(SD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){return function(n){var i=r,o=i.lib,a=o.WordArray,s=o.Hasher,l=i.algo,u=[],c=[];(function(){function h(b){for(var y=n.sqrt(b),x=2;x<=y;x++)if(!(b%x))return!1;return!0}function p(b){return(b-(b|0))*4294967296|0}for(var g=2,w=0;w<64;)h(g)&&(w<8&&(u[w]=p(n.pow(g,1/2))),c[w]=p(n.pow(g,1/3)),w++),g++})();var f=[],d=l.SHA256=s.extend({_doReset:function(){this._hash=new a.init(u.slice(0))},_doProcessBlock:function(h,p){for(var g=this._hash.words,w=g[0],b=g[1],y=g[2],x=g[3],C=g[4],S=g[5],_=g[6],A=g[7],P=0;P<64;P++){if(P<16)f[P]=h[p+P]|0;else{var R=f[P-15],T=(R<<25|R>>>7)^(R<<14|R>>>18)^R>>>3,k=f[P-2],B=(k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10;f[P]=T+f[P-7]+B+f[P-16]}var j=C&S^~C&_,G=w&b^w&y^b&y,Q=(w<<30|w>>>2)^(w<<19|w>>>13)^(w<<10|w>>>22),$=(C<<26|C>>>6)^(C<<21|C>>>11)^(C<<7|C>>>25),z=A+$+j+c[P]+f[P],X=Q+G;A=_,_=S,S=C,C=x+z|0,x=y,y=b,b=w,w=z+X|0}g[0]=g[0]+w|0,g[1]=g[1]+b|0,g[2]=g[2]+y|0,g[3]=g[3]+x|0,g[4]=g[4]+C|0,g[5]=g[5]+S|0,g[6]=g[6]+_|0,g[7]=g[7]+A|0},_doFinalize:function(){var h=this._data,p=h.words,g=this._nDataBytes*8,w=h.sigBytes*8;return p[w>>>5]|=128<<24-w%32,p[(w+64>>>9<<4)+14]=n.floor(g/4294967296),p[(w+64>>>9<<4)+15]=g,h.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var h=s.clone.call(this);return h._hash=this._hash.clone(),h}});i.SHA256=s._createHelper(d),i.HmacSHA256=s._createHmacHelper(d)}(Math),r.SHA256})}(B5)),B5.exports}var j5={exports:{}},ED;function Oye(){return ED||(ED=1,function(t,e){(function(r,n,i){t.exports=n(It(),N7())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.WordArray,a=n.algo,s=a.SHA256,l=a.SHA224=s.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var u=s._doFinalize.call(this);return u.sigBytes-=4,u}});n.SHA224=s._createHelper(l),n.HmacSHA224=s._createHmacHelper(l)}(),r.SHA224})}(j5)),j5.exports}var H5={exports:{}},_D;function kH(){return _D||(_D=1,function(t,e){(function(r,n,i){t.exports=n(It(),o4())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.Hasher,a=n.x64,s=a.Word,l=a.WordArray,u=n.algo;function c(){return s.create.apply(s,arguments)}var f=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],d=[];(function(){for(var p=0;p<80;p++)d[p]=c()})();var h=u.SHA512=o.extend({_doReset:function(){this._hash=new l.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(p,g){for(var w=this._hash.words,b=w[0],y=w[1],x=w[2],C=w[3],S=w[4],_=w[5],A=w[6],P=w[7],R=b.high,T=b.low,k=y.high,B=y.low,j=x.high,G=x.low,Q=C.high,$=C.low,z=S.high,X=S.low,se=_.high,ie=_.low,Z=A.high,te=A.low,J=P.high,ae=P.low,xe=R,Ae=T,ve=k,he=B,fe=j,Me=G,pt=Q,me=$,Pe=z,le=X,Le=se,ze=ie,Lt=Z,ye=te,Kt=J,Te=ae,st=0;st<80;st++){var nt,xr,Xn=d[st];if(st<16)xr=Xn.high=p[g+st*2]|0,nt=Xn.low=p[g+st*2+1]|0;else{var qo=d[st-15],hi=qo.high,Mr=qo.low,Mn=(hi>>>1|Mr<<31)^(hi>>>8|Mr<<24)^hi>>>7,on=(Mr>>>1|hi<<31)^(Mr>>>8|hi<<24)^(Mr>>>7|hi<<25),kr=d[st-2],nr=kr.high,Nn=kr.low,dn=(nr>>>19|Nn<<13)^(nr<<3|Nn>>>29)^nr>>>6,Ln=(Nn>>>19|nr<<13)^(Nn<<3|nr>>>29)^(Nn>>>6|nr<<26),pi=d[st-7],go=pi.high,an=pi.low,vi=d[st-16],hn=vi.high,ki=vi.low;nt=on+an,xr=Mn+go+(nt>>>0<on>>>0?1:0),nt=nt+Ln,xr=xr+dn+(nt>>>0<Ln>>>0?1:0),nt=nt+ki,xr=xr+hn+(nt>>>0<ki>>>0?1:0),Xn.high=xr,Xn.low=nt}var tt=Pe&Le^~Pe&Lt,yt=le&ze^~le&ye,pr=xe&ve^xe&fe^ve&fe,wr=Ae&he^Ae&Me^he&Me,lr=(xe>>>28|Ae<<4)^(xe<<30|Ae>>>2)^(xe<<25|Ae>>>7),ur=(Ae>>>28|xe<<4)^(Ae<<30|xe>>>2)^(Ae<<25|xe>>>7),Gr=(Pe>>>14|le<<18)^(Pe>>>18|le<<14)^(Pe<<23|le>>>9),sn=(le>>>14|Pe<<18)^(le>>>18|Pe<<14)^(le<<23|Pe>>>9),Xr=f[st],pn=Xr.high,Dr=Xr.low,Bt=Te+sn,vr=Kt+Gr+(Bt>>>0<Te>>>0?1:0),Bt=Bt+yt,vr=vr+tt+(Bt>>>0<yt>>>0?1:0),Bt=Bt+Dr,vr=vr+pn+(Bt>>>0<Dr>>>0?1:0),Bt=Bt+nt,vr=vr+xr+(Bt>>>0<nt>>>0?1:0),vn=ur+wr,Gt=lr+pr+(vn>>>0<ur>>>0?1:0);Kt=Lt,Te=ye,Lt=Le,ye=ze,Le=Pe,ze=le,le=me+Bt|0,Pe=pt+vr+(le>>>0<me>>>0?1:0)|0,pt=fe,me=Me,fe=ve,Me=he,ve=xe,he=Ae,Ae=Bt+vn|0,xe=vr+Gt+(Ae>>>0<Bt>>>0?1:0)|0}T=b.low=T+Ae,b.high=R+xe+(T>>>0<Ae>>>0?1:0),B=y.low=B+he,y.high=k+ve+(B>>>0<he>>>0?1:0),G=x.low=G+Me,x.high=j+fe+(G>>>0<Me>>>0?1:0),$=C.low=$+me,C.high=Q+pt+($>>>0<me>>>0?1:0),X=S.low=X+le,S.high=z+Pe+(X>>>0<le>>>0?1:0),ie=_.low=ie+ze,_.high=se+Le+(ie>>>0<ze>>>0?1:0),te=A.low=te+ye,A.high=Z+Lt+(te>>>0<ye>>>0?1:0),ae=P.low=ae+Te,P.high=J+Kt+(ae>>>0<Te>>>0?1:0)},_doFinalize:function(){var p=this._data,g=p.words,w=this._nDataBytes*8,b=p.sigBytes*8;g[b>>>5]|=128<<24-b%32,g[(b+128>>>10<<5)+30]=Math.floor(w/4294967296),g[(b+128>>>10<<5)+31]=w,p.sigBytes=g.length*4,this._process();var y=this._hash.toX32();return y},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:1024/32});n.SHA512=o._createHelper(h),n.HmacSHA512=o._createHmacHelper(h)}(),r.SHA512})}(H5)),H5.exports}var z5={exports:{}},AD;function Pye(){return AD||(AD=1,function(t,e){(function(r,n,i){t.exports=n(It(),o4(),kH())})(Fe,function(r){return function(){var n=r,i=n.x64,o=i.Word,a=i.WordArray,s=n.algo,l=s.SHA512,u=s.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var c=l._doFinalize.call(this);return c.sigBytes-=16,c}});n.SHA384=l._createHelper(u),n.HmacSHA384=l._createHmacHelper(u)}(),r.SHA384})}(z5)),z5.exports}var U5={exports:{}},OD;function Tye(){return OD||(OD=1,function(t,e){(function(r,n,i){t.exports=n(It(),o4())})(Fe,function(r){return function(n){var i=r,o=i.lib,a=o.WordArray,s=o.Hasher,l=i.x64,u=l.Word,c=i.algo,f=[],d=[],h=[];(function(){for(var w=1,b=0,y=0;y<24;y++){f[w+5*b]=(y+1)*(y+2)/2%64;var x=b%5,C=(2*w+3*b)%5;w=x,b=C}for(var w=0;w<5;w++)for(var b=0;b<5;b++)d[w+5*b]=b+(2*w+3*b)%5*5;for(var S=1,_=0;_<24;_++){for(var A=0,P=0,R=0;R<7;R++){if(S&1){var T=(1<<R)-1;T<32?P^=1<<T:A^=1<<T-32}S&128?S=S<<1^113:S<<=1}h[_]=u.create(A,P)}})();var p=[];(function(){for(var w=0;w<25;w++)p[w]=u.create()})();var g=c.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var w=this._state=[],b=0;b<25;b++)w[b]=new u.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(w,b){for(var y=this._state,x=this.blockSize/2,C=0;C<x;C++){var S=w[b+2*C],_=w[b+2*C+1];S=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360;var A=y[C];A.high^=_,A.low^=S}for(var P=0;P<24;P++){for(var R=0;R<5;R++){for(var T=0,k=0,B=0;B<5;B++){var A=y[R+5*B];T^=A.high,k^=A.low}var j=p[R];j.high=T,j.low=k}for(var R=0;R<5;R++)for(var G=p[(R+4)%5],Q=p[(R+1)%5],$=Q.high,z=Q.low,T=G.high^($<<1|z>>>31),k=G.low^(z<<1|$>>>31),B=0;B<5;B++){var A=y[R+5*B];A.high^=T,A.low^=k}for(var X=1;X<25;X++){var T,k,A=y[X],se=A.high,ie=A.low,Z=f[X];Z<32?(T=se<<Z|ie>>>32-Z,k=ie<<Z|se>>>32-Z):(T=ie<<Z-32|se>>>64-Z,k=se<<Z-32|ie>>>64-Z);var te=p[d[X]];te.high=T,te.low=k}var J=p[0],ae=y[0];J.high=ae.high,J.low=ae.low;for(var R=0;R<5;R++)for(var B=0;B<5;B++){var X=R+5*B,A=y[X],xe=p[X],Ae=p[(R+1)%5+5*B],ve=p[(R+2)%5+5*B];A.high=xe.high^~Ae.high&ve.high,A.low=xe.low^~Ae.low&ve.low}var A=y[0],he=h[P];A.high^=he.high,A.low^=he.low}},_doFinalize:function(){var w=this._data,b=w.words;this._nDataBytes*8;var y=w.sigBytes*8,x=this.blockSize*32;b[y>>>5]|=1<<24-y%32,b[(n.ceil((y+1)/x)*x>>>5)-1]|=128,w.sigBytes=b.length*4,this._process();for(var C=this._state,S=this.cfg.outputLength/8,_=S/8,A=[],P=0;P<_;P++){var R=C[P],T=R.high,k=R.low;T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,A.push(k),A.push(T)}return new a.init(A,S)},clone:function(){for(var w=s.clone.call(this),b=w._state=this._state.slice(0),y=0;y<25;y++)b[y]=b[y].clone();return w}});i.SHA3=s._createHelper(g),i.HmacSHA3=s._createHmacHelper(g)}(Math),r.SHA3})}(U5)),U5.exports}var V5={exports:{}},PD;function kye(){return PD||(PD=1,function(t,e){(function(r,n){t.exports=n(It())})(Fe,function(r){/** @preserve

  ðŸ“ assets/index-29JfJxHM.js: presigned-url/${he}/${fe}`:`api/generate/presigned-url/${he}`;console.log("Identifier",he),console.log("PageIdentifier",fe);const me=await(await fetch(`https://${(J=t==null?void 0:t.sfData)==null?void 0:J.url}/${Me}`,{method:"POST",body:JSON.stringify(k),headers:{authorization:`Bearer ${(ae=t==null?void 0:t.sfData)==null?void 0:ae.apiToken}`,"Content-Type":"application/json"}})).json();if(me!=null&&me.error)throw new Error(me==null?void 0:me.error);B=await(await fetch((xe=me==null?void 0:me.data)==null?void 0:xe.url)).arrayBuffer()}catch(he){if(console.log(he),he.message==="No files found for the given identifier"){s(!0);return}}let j;try{j=await ds.load(B,{ignoreEncryption:!0,throwOnInvalidObject:!0})}catch(he){if(console.log(he),(p==null?void 0:p.current)>1)return;await _();return}let G;try{j!=null&&j.save?G=await j.save({ignoreEncryption:!0}):o(!0)}catch{o(!0)}try{const fe=await A9({data:G}).promise,Me=[];for(let le=1;le<=fe.numPages;le++)Me.push(fe.getPage(le));const pt=await Promise.all(Me);o(!1);const me=(Ae=t==null?void 0:t.annotations)!=null&&Ae.length?[...t==null?void 0:t.annotations,...Array(pt==null?void 0:pt.length).fill([])]:Array(pt.length).fill([]),Pe=(ve=t==null?void 0:t.comments)!=null&&ve.length?[...t==null?void 0:t.comments,...Array(pt==null?void 0:pt.length).fill([])]:Array(pt.length).fill([]);e(le=>({...le,originalPdfBytes:G,PDFDocumentLoaded:j,pdfjsLoaded:fe,pdfPages:pt,annotations:me,comments:Pe})),window.parent.postMessage({message:{action:"pdf-success-on-open",sender:"PdfEditor",data:{}}})}catch{o(!0)}};return q.useLayoutEffect(()=>(n!=null&&n.current||A(),document.addEventListener("mousedown",S),()=>{var k;(k=t.pdfjsLoaded)==null||k.destroy(),document.removeEventListener("mousedown",S),document.removeEventListener("mouseenter",S)}),[]),q.useEffect(()=>{let k=0;g>w&&(k=g),w>g&&(k=w);const B=b.at(-1);B-k<5&&(h(Math.random()),y(j=>{const G=[...j];for(let Q=1;Q<6;Q++)G.push(B+Q);return OH(G)}))},[g,w]),q.useEffect(()=>{const k=x.sort((B,j)=>B-j);console.log(k),k.length>0&&e(B=>({...B,windowFocusedPage:k[0]}))},[x]),E.jsxs("div",{style:{width:"max-content",height:"auto",display:"flex",flexDirection:"column",alignItems:"center",gap:"2em",margin:"0 auto",padding:"0 2em"},ref:r,children:[a&&E.jsx($ye,{}),i&&E.jsx(Jye,{fetchPdf:A}),(R=(P=t==null?void 0:t.pdfPages)==null?void 0:P.filter((k,B)=>b==null?void 0:b.includes(B)))==null?void 0:R.map((k,B)=>{var j;return E.jsx(yye,{page:k,pageIndex:B,setPagesInsideViewport:C},(j=k==null?void 0:k._pageInfo)==null?void 0:j.refStr)}),E.jsx(eye,{}),E.jsx(tye,{ctx:t}),!((T=t==null?void 0:t.selectedAnnotation)!=null&&T.Id)&&E.jsx(rye,{selectedAnnotation:t.selectedAnnotation}),E.jsx(iye,{}),E.jsx(bye,{ctx:t,dispatch:e}),E.jsx(Qye,{saveVersion:t==null?void 0:t.saveVersion,annotations:t==null?void 0:t.annotations,comments:t==null?void 0:t.comments,PDFDocumentLoaded:t==null?void 0:t.PDFDocumentLoaded,saveSuccess:t==null?void 0:t.saveSuccess,sfData:t==null?void 0:t.sfData}),(t==null?void 0:t.lockPdf)&&E.jsx(o3,{}),l&&E.jsx(o3,{message:"Fixing PDF please wait..."})]})},tbe="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10.6161%201.84619H1.38537C1.13152%201.84619%200.923828%202.05388%200.923828%202.30773V9.69235C0.923828%209.94619%201.13152%2010.1539%201.38537%2010.1539H10.6161C10.87%2010.1539%2011.0777%209.94619%2011.0777%209.69235V2.30773C11.0777%202.05388%2010.87%201.84619%2010.6161%201.84619ZM10.1546%209.23058H1.84691V2.76904H10.1546V9.23058ZM4.84693%208.76893H2.56231C2.42385%208.76893%202.33154%208.67662%202.33154%208.53816V3.46124C2.33154%203.32278%202.42385%203.23047%202.56231%203.23047H4.84693C4.98539%203.23047%205.0777%203.32278%205.0777%203.46124V8.53816C5.0777%208.67662%204.98539%208.76893%204.84693%208.76893Z'%20fill='%23747474'%20/%3e%3c/svg%3e",rbe="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M0.923828%201.84619H11.0777V10.1539H0.923828V1.84619ZM1.84691%202.76904V9.23058H10.1546V2.76904H1.84691ZM6.92383%203.23047H9.69306V8.76893H6.92383V3.23047Z'%20fill='%23747474'%20/%3e%3c/svg%3e",x_=({position:t="left",column:e})=>{const[,r]=ht(),n=()=>{r(i=>{const o=new Set(Array.from(i.columns));return o.has(e)?o.delete(e):o.add(e),{...i,columns:o}})};return E.jsx("button",{style:{padding:"3px",border:"1px solid #747474",backgroundColor:"#FFFFFF",borderRadius:"4px",width:"27.5px"},onClick:n,children:E.jsx("img",{src:t==="left"?tbe:rbe})})};x_.propTypes={position:m.string,column:m.number.isRequired};const nbe=()=>{var e,r;const[t]=ht();return q.useEffect(()=>{var n,i;(n=t==null?void 0:t.pdfPages)!=null&&n.length&&window.parent.postMessage({message:{sender:"PdfEditor",query:"document-page-count",action:"document-page-count",data:{pageCount:(i=t==null?void 0:t.pdfPages)==null?void 0:i.length}}},"*")},[(e=t==null?void 0:t.pdfPages)==null?void 0:e.length]),q.useEffect(()=>{var n,i,o;!((n=t==null?void 0:t.pdfPages)!=null&&n.length)||(o=(i=t==null?void 0:t.sfData)==null?void 0:i.docListEntry)!=null&&o.MasterDocument__c||window.parent.postMessage({message:{sender:"PdfEditor",query:"master-page-focus",action:"master-page-focus",data:{page:(t==null?void 0:t.windowFocusedPage)-1}}},"*")},[t==null?void 0:t.windowFocusedPage]),E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5em"},children:[E.jsx("p",{style:{fontSize:"14px",width:"22px",height:"22px",backgroundColor:"#444444",color:"#fff",display:"flex",justifyContent:"center",borderRadius:"2px"},children:t==null?void 0:t.windowFocusedPage}),E.jsx("p",{children:"/"}),E.jsx("p",{style:{fontSize:"14px",height:"22px"},children:(r=t==null?void 0:t.pdfPages)==null?void 0:r.length})]})},ibe=t=>E.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:E.jsx("path",{d:"M7.91018 7.02988L1.43018 13.5199L7.92018 19.9999L14.4102 13.5199L7.91018 7.02988ZM4.26018 13.5199L7.92018 9.85988L11.5702 13.5199L7.91018 17.1799L4.26018 13.5199ZM19.9302 7.25988C18.1802 5.49988 15.8702 4.61988 13.5702 4.61988V1.37988L9.33018 5.61988L13.5702 9.85988V6.61988C15.3602 6.61988 17.1502 7.29988 18.5202 8.66988C21.2502 11.3999 21.2502 15.8399 18.5202 18.5699C17.1502 19.9399 15.3602 20.6199 13.5702 20.6199C12.6002 20.6199 11.6302 20.4099 10.7302 20.0099L9.24018 21.4999C10.5902 22.2399 12.0802 22.6199 13.5702 22.6199C15.8702 22.6199 18.1802 21.7399 19.9302 19.9799C23.4502 16.4699 23.4502 10.7699 19.9302 7.25988Z",fill:"#747474"})}),obe=t=>E.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:E.jsx("path",{d:"M1.5 13.5C1.5 18.47 5.53 22.5 10.5 22.5C12.26 22.5 13.9 21.99 15.29 21.12L13.83 19.66C12.84 20.19 11.7 20.5 10.5 20.5C6.64 20.5 3.5 17.36 3.5 13.5C3.5 9.64 6.64 6.5 10.5 6.5H10.67L9.09 8.09L10.5 9.5L14.5 5.5L10.5 1.5L9.08 2.91L10.67 4.5H10.5C5.53 4.5 1.5 8.53 1.5 13.5ZM10.5 13.5L16.5 19.5L22.5 13.5L16.5 7.5L10.5 13.5ZM16.5 16.67L13.33 13.5L16.5 10.33L19.67 13.5L16.5 16.67Z",fill:"#747474"})}),abe=()=>{var p,g,w;const[t,e]=q.useState(!1),[r,n]=ht(),[i,o]=q.useState(!1),[a,s]=q.useState(null),l=r==null?void 0:r.PDFDocumentLoaded,u=((p=r==null?void 0:r.annotations.at((r==null?void 0:r.windowFocusedPage)-1))==null?void 0:p.length)>0,c=((w=(g=r==null?void 0:r.comments)==null?void 0:g.at((r==null?void 0:r.windowFocusedPage)-1))==null?void 0:w.length)>0,f=!u&&!c,d=r.isMasterDoc;async function h(b=!0){var y,x,C,S,_,A,P;if(d){const R=r.sfData.masterDocumentPages.at(r.windowFocusedPage-1),T={identifier:`${(x=(y=R==null?void 0:R.Original_Document_Page__r)==null?void 0:y.Parent__r)==null?void 0:x.Identifier__c}/${(C=R==null?void 0:R.Original_Document_Page__r)==null?void 0:C.Identifier__c}`,rotationDegrees:b?90:-90},k=await fetch(`https://${(S=r==null?void 0:r.sfData)==null?void 0:S.url
     Context:
       282    * derived from CryptoJS.mode.CTR
       283    * Jan Hruby jhruby.web@gmail.com
       284 â†’  */return r.mode.CTRGladman=function(){var n=r.lib.BlockCipherMode.extend();function i(s){if((s>>24&255)===255){var l=s>>16&255,u=s>>8&255,c=s&255;l===255?(l=0,u===255?(u=0,c===255?c=0:++c):++u):++l,s=0,s+=l<<16,s+=u<<8,s+=c}else s+=1<<24;return s}function o(s){return(s[0]=i(s[0]))===0&&(s[1]=i(s[1])),s}var a=n.Encryptor=n.extend({processBlock:function(s,l){var u=this._cipher,c=u.blockSize,f=this._iv,d=this._counter;f&&(d=this._counter=f.slice(0),this._iv=void 0),o(d);var h=d.slice(0);u.encryptBlock(h,0);for(var p=0;p<c;p++)s[l+p]^=h[p]}});return n.Decryptor=a,n}(),r.mode.CTRGladman})}(Z5)),Z5.exports}var Q5={exports:{}},ND;function Mye(){return ND||(ND=1,function(t,e){(function(r,n,i){t.exports=n(It(),Gn())})(Fe,function(r){return r.mode.OFB=function(){var n=r.lib.BlockCipherMode.extend(),i=n.Encryptor=n.extend({processBlock:function(o,a){var s=this._cipher,l=s.blockSize,u=this._iv,c=this._keystream;u&&(c=this._keystream=u.slice(0),this._iv=void 0),s.encryptBlock(c,0);for(var f=0;f<l;f++)o[a+f]^=c[f]}});return n.Decryptor=i,n}(),r.mode.OFB})}(Q5)),Q5.exports}var J5={exports:{}},LD;function Nye(){return LD||(LD=1,function(t,e){(function(r,n,i){t.exports=n(It(),Gn())})(Fe,function(r){return r.mode.ECB=function(){var n=r.lib.BlockCipherMode.extend();return n.Encryptor=n.extend({processBlock:function(i,o){this._cipher.encryptBlock(i,o)}}),n.Decryptor=n.extend({processBlock:function(i,o){this._cipher.decryptBlock(i,o)}}),n}(),r.mode.ECB})}(J5)),J5.exports}var $5={exports:{}},BD;function Lye(){return BD||(BD=1,function(t,e){(function(r,n,i){t.exports=n(It(),Gn())})(Fe,function(r){return r.pad.AnsiX923={pad:function(n,i){var o=n.sigBytes,a=i*4,s=a-o%a,l=o+s-1;n.clamp(),n.words[l>>>2]|=s<<24-l%4*8,n.sigBytes+=s},unpad:function(n){var i=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=i}},r.pad.Ansix923})}($5)),$5.exports}var e8={exports:{}},jD;function Bye(){return jD||(jD=1,function(t,e){(function(r,n,i){t.exports=n(It(),Gn())})(Fe,function(r){return r.pad.Iso10126={pad:function(n,i){var o=i*4,a=o-n.sigBytes%o;n.concat(r.lib.WordArray.random(a-1)).concat(r.lib.WordArray.create([a<<24],1))},unpad:function(n){var i=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=i}},r.pad.Iso10126})}(e8)),e8.exports}var t8={exports:{}},HD;function jye(){return HD||(HD=1,function(t,e){(function(r,n,i){t.exports=n(It(),Gn())})(Fe,function(r){return r.pad.Iso97971={pad:function(n,i){n.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(n,i)},unpad:function(n){r.pad.ZeroPadding.unpad(n),n.sigBytes--}},r.pad.Iso97971})}(t8)),t8.exports}var r8={exports:{}},zD;function Hye(){return zD||(zD=1,function(t,e){(function(r,n,i){t.exports=n(It(),Gn())})(Fe,function(r){return r.pad.ZeroPadding={pad:function(n,i){var o=i*4;n.clamp(),n.sigBytes+=o-(n.sigBytes%o||o)},unpad:function(n){for(var i=n.words,o=n.sigBytes-1,o=n.sigBytes-1;o>=0;o--)if(i[o>>>2]>>>24-o%4*8&255){n.sigBytes=o+1;break}}},r.pad.ZeroPadding})}(r8)),r8.exports}var n8={exports:{}},UD;function zye(){return UD||(UD=1,function(t,e){(function(r,n,i){t.exports=n(It(),Gn())})(Fe,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})}(n8)),n8.exports}var i8={exports:{}},VD;function Uye(){return VD||(VD=1,function(t,e){(function(r,n,i){t.exports=n(It(),Gn())})(Fe,function(r){return function(n){var i=r,o=i.lib,a=o.CipherParams,s=i.enc,l=s.Hex,u=i.format;u.Hex={stringify:function(c){return c.ciphertext.toString(l)},parse:function(c){var f=l.parse(c);return a.create({ciphertext:f})}}}(),r.format.Hex})}(i8)),i8.exports}var o8={exports:{}},WD;function Vye(){return WD||(WD=1,function(t,e){(function(r,n,i){t.exports=n(It(),kh(),Dh(),af(),Gn())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.BlockCipher,a=n.algo,s=[],l=[],u=[],c=[],f=[],d=[],h=[],p=[],g=[],w=[];(function(){for(var x=[],C=0;C<256;C++)C<128?x[C]=C<<1:x[C]=C<<1^283;for(var S=0,_=0,C=0;C<256;C++){var A=_^_<<1^_<<2^_<<3^_<<4;A=A>>>8^A&255^99,s[S]=A,l[A]=S;var P=x[S],R=x[P],T=x[R],k=x[A]*257^A*16843008;u[S]=k<<24|k>>>8,c[S]=k<<16|k>>>16,f[S]=k<<8|k>>>24,d[S]=k;var k=T*16843009^R*65537^P*257^S*16843008;h[A]=k<<24|k>>>8,p[A]=k<<16|k>>>16,g[A]=k<<8|k>>>24,w[A]=k,S?(S=P^x[x[x[T^P]]],_^=x[x[_]]):S=_=1}})();var b=[0,1,2,4,8,16,32,64,128,27,54],y=a.AES=o.extend({_doReset:function(){var x;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var C=this._keyPriorReset=this._key,S=C.words,_=C.sigBytes/4,A=this._nRounds=_+6,P=(A+1)*4,R=this._keySchedule=[],T=0;T<P;T++)T<_?R[T]=S[T]:(x=R[T-1],T%_?_>6&&T%_==4&&(x=s[x>>>24]<<24|s[x>>>16&255]<<16|s[x>>>8&255]<<8|s[x&255]):(x=x<<8|x>>>24,x=s[x>>>24]<<24|s[x>>>16&255]<<16|s[x>>>8&255]<<8|s[x&255],x^=b[T/_|0]<<24),R[T]=R[T-_]^x);for(var k=this._invKeySchedule=[],B=0;B<P;B++){var T=P-B;if(B%4)var x=R[T];else var x=R[T-4];B<4||T<=4?k[B]=x:k[B]=h[s[x>>>24]]^p[s[x>>>16&255]]^g[s[x>>>8&255]]^w[s[x&255]]}}},encryptBlock:function(x,C){this._doCryptBlock(x,C,this._keySchedule,u,c,f,d,s)},decryptBlock:function(x,C){var S=x[C+1];x[C+1]=x[C+3],x[C+3]=S,this._doCryptBlock(x,C,this._invKeySchedule,h,p,g,w,l);var S=x[C+1];x[C+1]=x[C+3],x[C+3]=S},_doCryptBlock:function(x,C,S,_,A,P,R,T){for(var k=this._nRounds,B=x[C]^S[0],j=x[C+1]^S[1],G=x[C+2]^S[2],Q=x[C+3]^S[3],$=4,z=1;z<k;z++){var X=_[B>>>24]^A[j>>>16&255]^P[G>>>8&255]^R[Q&255]^S[$++],se=_[j>>>24]^A[G>>>16&255]^P[Q>>>8&255]^R[B&255]^S[$++],ie=_[G>>>24]^A[Q>>>16&255]^P[B>>>8&255]^R[j&255]^S[$++],Z=_[Q>>>24]^A[B>>>16&255]^P[j>>>8&255]^R[G&255]^S[$++];B=X,j=se,G=ie,Q=Z}var X=(T[B>>>24]<<24|T[j>>>16&255]<<16|T[G>>>8&255]<<8|T[Q&255])^S[$++],se=(T[j>>>24]<<24|T[G>>>16&255]<<16|T[Q>>>8&255]<<8|T[B&255])^S[$++],ie=(T[G>>>24]<<24|T[Q>>>16&255]<<16|T[B>>>8&255]<<8|T[j&255])^S[$++],Z=(T[Q>>>24]<<24|T[B>>>16&255]<<16|T[j>>>8&255]<<8|T[G&255])^S[$++];x[C]=X,x[C+1]=se,x[C+2]=ie,x[C+3]=Z},keySize:256/32});n.AES=o._createHelper(y)}(),r.AES})}(o8)),o8.exports}var a8={exports:{}},qD;function Wye(){return qD||(qD=1,function(t,e){(function(r,n,i){t.exports=n(It(),kh(),Dh(),af(),Gn())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.WordArray,a=i.BlockCipher,s=n.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=s.DES=a.extend({_doReset:function(){for(var b=this._key,y=b.words,x=[],C=0;C<56;C++){var S=l[C]-1;x[C]=y[S>>>5]>>>31-S%32&1}for(var _=this._subKeys=[],A=0;A<16;A++){for(var P=_[A]=[],R=c[A],C=0;C<24;C++)P[C/6|0]|=x[(u[C]-1+R)%28]<<31-C%6,P[4+(C/6|0)]|=x[28+(u[C+24]-1+R)%28]<<31-C%6;P[0]=P[0]<<1|P[0]>>>31;for(var C=1;C<7;C++)P[C]=P[C]>>>(C-1)*4+3;P[7]=P[7]<<5|P[7]>>>27}for(var T=this._invSubKeys=[],C=0;C<16;C++)T[C]=_[15-C]},encryptBlock:function(b,y){this._doCryptBlock(b,y,this._subKeys)},decryptBlock:function(b,y){this._doCryptBlock(b,y,this._invSubKeys)},_doCryptBlock:function(b,y,x){this._lBlock=b[y],this._rBlock=b[y+1],p.call(this,4,252645135),p.call(this,16,65535),g.call(this,2,858993459),g.call(this,8,16711935),p.call(this,1,1431655765);for(var C=0;C<16;C++){for(var S=x[C],_=this._lBlock,A=this._rBlock,P=0,R=0;R<8;R++)P|=f[R][((A^S[R])&d[R])>>>0];this._lBlock=A,this._rBlock=_^P}var T=this._lBlock;this._lBlock=this._rBlock,this._rBlock=T,p.call(this,1,1431655765),g.call(this,8,16711935),g.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),b[y]=this._lBlock,b[y+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function p(b,y){var x=(this._lBlock>>>b^this._rBlock)&y;this._rBlock^=x,this._lBlock^=x<<b}function g(b,y){var x=(this._rBlock>>>b^this._lBlock)&y;this._lBlock^=x,this._rBlock^=x<<b}n.DES=a._createHelper(h);var w=s.TripleDES=a.extend({_doReset:function(){var b=this._key,y=b.words;if(y.length!==2&&y.length!==4&&y.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var x=y.slice(0,2),C=y.length<4?y.slice(0,2):y.slice(2,4),S=y.length<6?y.slice(0,2):y.slice(4,6);this._des1=h.createEncryptor(o.create(x)),this._des2=h.createEncryptor(o.create(C)),this._des3=h.createEncryptor(o.create(S))},encryptBlock:function(b,y){this._des1.encryptBlock(b,y),this._des2.decryptBlock(b,y),this._des3.encryptBlock(b,y)},decryptBlock:function(b,y){this._des3.decryptBlock(b,y),this._des2.encryptBlock(b,y),this._des1.decryptBlock(b,y)},keySize:192/32,ivSize:64/32,blockSize:64/32});n.TripleDES=a._createHelper(w)}(),r.TripleDES})}(a8)),a8.exports}var s8={exports:{}},KD;function qye(){return KD||(KD=1,function(t,e){(function(r,n,i){t.exports=n(It(),kh(),Dh(),af(),Gn())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.StreamCipher,a=n.algo,s=a.RC4=o.extend({_doReset:function(){for(var c=this._key,f=c.words,d=c.sigBytes,h=this._S=[],p=0;p<256;p++)h[p]=p;for(var p=0,g=0;p<256;p++){var w=p%d,b=f[w>>>2]>>>24-w%4*8&255;g=(g+h[p]+b)%256;var y=h[p];h[p]=h[g],h[g]=y}this._i=this._j=0},_doProcessBlock:function(c,f){c[f]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var c=this._S,f=this._i,d=this._j,h=0,p=0;p<4;p++){f=(f+1)%256,d=(d+c[f])%256;var g=c[f];c[f]=c[d],c[d]=g,h|=c[(c[f]+c[d])%256]<<24-p*8}return this._i=f,this._j=d,h}n.RC4=o._createHelper(s);var u=a.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var c=this.cfg.drop;c>0;c--)l.call(this)}});n.RC4Drop=o._createHelper(u)}(),r.RC4})}(s8)),s8.exports}var l8={exports:{}},GD;function Kye(){return GD||(GD=1,function(t,e){(function(r,n,i){t.exports=n(It(),kh(),Dh(),af(),Gn())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.StreamCipher,a=n.algo,s=[],l=[],u=[],c=a.Rabbit=o.extend({_doReset:function(){for(var d=this._key.words,h=this.cfg.iv,p=0;p<4;p++)d[p]=(d[p]<<8|d[p]>>>24)&16711935|(d[p]<<24|d[p]>>>8)&4278255360;var g=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],w=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var p=0;p<4;p++)f.call(this);for(var p=0;p<8;p++)w[p]^=g[p+4&7];if(h){var b=h.words,y=b[0],x=b[1],C=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,S=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,_=C>>>16|S&4294901760,A=S<<16|C&65535;w[0]^=C,w[1]^=_,w[2]^=S,w[3]^=A,w[4]^=C,w[5]^=_,w[6]^=S,w[7]^=A;for(var p=0;p<4;p++)f.call(this)}},_doProcessBlock:function(d,h){var p=this._X;f.call(this),s[0]=p[0]^p[5]>>>16^p[3]<<16,s[1]=p[2]^p[7]>>>16^p[5]<<16,s[2]=p[4]^p[1]>>>16^p[7]<<16,s[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)s[g]=(s[g]<<8|s[g]>>>24)&16711935|(s[g]<<24|s[g]>>>8)&4278255360,d[h+g]^=s[g]},blockSize:128/32,ivSize:64/32});function f(){for(var d=this._X,h=this._C,p=0;p<8;p++)l[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var g=d[p]+h[p],w=g&65535,b=g>>>16,y=((w*w>>>17)+w*b>>>15)+b*b,x=((g&4294901760)*g|0)+((g&65535)*g|0);u[p]=y^x}d[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,d[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,d[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,d[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,d[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,d[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,d[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,d[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}n.Rabbit=o._createHelper(c)}(),r.Rabbit})}(l8)),l8.exports}var u8={exports:{}},XD;function Gye(){return XD||(XD=1,function(t,e){(function(r,n,i){t.exports=n(It(),kh(),Dh(),af(),Gn())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.StreamCipher,a=n.algo,s=[],l=[],u=[],c=a.RabbitLegacy=o.extend({_doReset:function(){var d=this._key.words,h=this.cfg.iv,p=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],g=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var w=0;w<4;w++)f.call(this);for(var w=0;w<8;w++)g[w]^=p[w+4&7];if(h){var b=h.words,y=b[0],x=b[1],C=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,S=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,_=C>>>16|S&4294901760,A=S<<16|C&65535;g[0]^=C,g[1]^=_,g[2]^=S,g[3]^=A,g[4]^=C,g[5]^=_,g[6]^=S,g[7]^=A;for(var w=0;w<4;w++)f.call(this)}},_doProcessBlock:function(d,h){var p=this._X;f.call(this),s[0]=p[0]^p[5]>>>16^p[3]<<16,s[1]=p[2]^p[7]>>>16^p[5]<<16,s[2]=p[4]^p[1]>>>16^p[7]<<16,s[3]=p[6]^p[3]>>>16^p[1]<<16;for(var g=0;g<4;g++)s[g]=(s[g]<<8|s[g]>>>24)&16711935|(s[g]<<24|s[g]>>>8)&4278255360,d[h+g]^=s[g]},blockSize:128/32,ivSize:64/32});function f(){for(var d=this._X,h=this._C,p=0;p<8;p++)l[p]=h[p];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var p=0;p<8;p++){var g=d[p]+h[p],w=g&65535,b=g>>>16,y=((w*w>>>17)+w*b>>>15)+b*b,x=((g&4294901760)*g|0)+((g&65535)*g|0);u[p]=y^x}d[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,d[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,d[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,d[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,d[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,d[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,d[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,d[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}n.RabbitLegacy=o._createHelper(c)}(),r.RabbitLegacy})}(u8)),u8.exports}var c8={exports:{}},YD;function Xye(){return YD||(YD=1,function(t,e){(function(r,n,i){t.exports=n(It(),kh(),Dh(),af(),Gn())})(Fe,function(r){return function(){var n=r,i=n.lib,o=i.BlockCipher,a=n.algo;const s=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],u=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var c={pbox:[],sbox:[]};function f(w,b){let y=b>>24&255,x=b>>16&255,C=b>>8&255,S=b&255,_=w.sbox[0][y]+w.sbox[1][x];return _=_^w.sbox[2][C],_=_+w.sbox[3][S],_}function d(w,b,y){let x=b,C=y,S;for(let _=0;_<s;++_)x=x^w.pbox[_],C=f(w,x)^C,S=x,x=C,C=S;return S=x,x=C,C=S,C=C^w.pbox[s],x=x^w.pbox[s+1],{left:x,right:C}}function h(w,b,y){let x=b,C=y,S;for(let _=s+1;_>1;--_)x=x^w.pbox[_],C=f(w,x)^C,S=x,x=C,C=S;return S=x,x=C,C=S,C=C^w.pbox[1],x=x^w.pbox[0],{left:x,right:C}}function p(w,b,y){for(let A=0;A<4;A++){w.sbox[A]=[];for(let P=0;P<256;P++)w.sbox[A][P]=u[A][P]}let x=0;for(let A=0;A<s+2;A++)w.pbox[A]=l[A]^b[x],x++,x>=y&&(x=0);let C=0,S=0,_=0;for(let A=0;A<s+2;A+=2)_=d(w,C,S),C=_.left,S=_.right,w.pbox[A]=C,w.pbox[A+1]=S;for(let A=0;A<4;A++)for(let P=0;P<256;P+=2)_=d(w,C,S),C=_.left,S=_.right,w.sbox[A][P]=C,w.sbox[A][P+1]=S;return!0}var g=a.Blowfish=o.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var w=this._keyPriorReset=this._key,b=w.words,y=w.sigBytes/4;p(c,b,y)}},encryptBlock:function(w,b){var y=d(c,w[b],w[b+1]);w[b]=y.left,w[b+1]=y.right},decryptBlock:function(w,b){var y=h(c,w[b],w[b+1]);w[b]=y.left,w[b+1]=y.right},blockSize:64/32,keySize:128/32,ivSize:64/32});n.Blowfish=o._createHelper(g)}(),r.Blowfish})}(c8)),c8.exports}(function(t,e){(function(r,n,i){t.exports=n(It(),o4(),Eye(),_ye(),kh(),Aye(),Dh(),TH(),N7(),Oye(),kH(),Pye(),Tye(),kye(),L7(),Dye(),af(),Gn(),Rye(),Fye(),Iye(),Mye(),Nye(),Lye(),Bye(),jye(),Hye(),zye(),Uye(),Vye(),Wye(),qye(),Kye(),Gye(),Xye())})(Fe,function(r){return r})})(PH);var Yye=PH.exports;const f8=Kn(Yye),Zye=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=i=>{const o=i.target.result,a=f8.MD5(f8.enc.Latin1.parse(o)),s=f8.enc.Base64.stringify(a);e(s)},n.onerror=i=>r(i),n.readAsBinaryString(t)}),Qye=({PDFDocumentLoaded:t,annotations:e=[],comments:r=[],saveVersion:n,saveSuccess:i,sfData:o={}})=>{const[a,s]=q.useState(new AbortController);return a.signal,q.useEffect(()=>{i&&window.parent.postMessage({message:{sender:"PdfEditor",query:"document-save-end",action:"document-save-end",data:{}}},"*")},[i]),q.useEffect(()=>{if(!n)return()=>{};async function l(){var p,g,w;const c=e==null?void 0:e.map(b=>b==null?void 0:b.map(y=>E1(y,["Id","Hidden","LastModifiedDate","LastModifiedBy","LastModifiedById","CreatedDate","CreatedBy","CreatedById","SystemModstamp","OwnerId"])));window.parent.postMessage({message:{sender:"PdfEditor",query:"document-save-start",action:"document-save-start",data:{}}},"*");const f=await(t==null?void 0:t.save()),d=new Blob([f],{type:"application/pdf"}),h=await Zye(d);console.log(h),await xye({bytes:f,annotations:c,comments:r,url:`https://${o==null?void 0:o.url}${o==null?void 0:o.uploadEndpoint}`,authToken:o==null?void 0:o.apiToken,fileName:(p=o==null?void 0:o.docListEntry)==null?void 0:p.Name,Document__c:(g=o==null?void 0:o.docListEntry)==null?void 0:g.Document__c,orgUrl:o==null?void 0:o.url,Identifier__c:(w=o==null?void 0:o.docListEntry)==null?void 0:w.Identifier__c}),s(new AbortController)}let u=setTimeout(()=>{l()},1e3);return()=>{a.abort(),clearTimeout(u),s(new AbortController)}},[n]),E.jsx(E.Fragment,{})},Jye=({fetchPdf:t})=>{const[e]=ht(),[r,n]=q.useState(""),[i,o]=q.useState(!1),[a,s]=q.useState({visible:!1,message:""}),[l,u]=q.useState(!1),c=()=>{console.log("click"),u(d=>!d)},f=async()=>{var h,p,g,w,b,y,x,C,S,_;if(!r.trim())return;o(!0);const d={identifier:(w=(g=(p=(h=e==null?void 0:e.sfData)==null?void 0:h.docListEntry)==null?void 0:p.Document__c)==null?void 0:g.split("."))==null?void 0:w.pop(),password:r,email:((y=(b=e==null?void 0:e.sfData)==null?void 0:b.loggedUser)==null?void 0:y.email)??"",DleId:(C=(x=e==null?void 0:e.sfData)==null?void 0:x.docListEntry)==null?void 0:C.Id};try{if(!(await fetch(`https://${(S=e==null?void 0:e.sfData)==null?void 0:S.url}/api/pdf/remove-password`,{method:"POST",body:JSON.stringify(d),headers:{authorization:`Bearer ${(_=e==null?void 0:e.sfData)==null?void 0:_.apiToken}`,"Content-Type":"application/json"}})).ok)throw new Error("Invalid password");await new Promise(P=>setTimeout(P,3e3)),await t()}catch{s({visible:!0,message:"Error unlocking the document, please check the password"})}finally{o(!1)}};return E.jsxs(hl,{onRequestClose:()=>{},prompt:"error",title:"Error opening the pdf",isOpen:!0,footer:i?null:E.jsx(Nt,{disabled:i||!r.trim(),label:"Unlock",onClick:f},"buttonpword"),children:[E.jsx(Ay,{children:a.visible&&E.jsx(qp,{onRequestClose:()=>s({visible:!1,message:""}),labels:{heading:a.message},variant:"error",duration:5e3})}),E.jsx("p",{style:{paddingTop:"1.5em"},children:"The PDF is password protected. Please enter the password to unlock it."}),i&&E.jsx(Ch,{size:"large",variant:"base",assistiveText:{label:"Loading..."},containerStyle:{opacity:"1",background:"rgba(0,0,0,0.2)"}}),!i&&E.jsxs("div",{style:{padding:"1em 0",position:"relative"},children:[E.jsx(Ai,{id:"doc-password-input",type:l?"text":"password",value:r,onChange:(d,{value:h})=>n(h),label:"Document password"}),E.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"63%",right:"0.8rem",transform:"translateY(-50%)"},onClick:c,children:E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l?E.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.9385 7.72178C15.4462 6.73716 14.8 5.84485 14 5.13716L11.3847 7.72178V7.9987C11.3847 9.87562 9.87698 11.3833 8.00007 11.3833H7.72315L6.06162 13.0449C6.677 13.1679 7.32315 13.2602 7.9693 13.2602C11.4462 13.2602 14.4616 11.2295 15.9077 8.30639C16.0308 8.09101 16.0308 7.90639 15.9385 7.72178ZM14.923 1.72187L14.2768 1.07571C14.0922 0.891097 13.7538 0.921866 13.5384 1.16802L11.2922 3.41417C10.2769 2.9834 9.16917 2.76802 7.99995 2.76802C4.52305 2.76802 1.50768 4.79879 0.0615399 7.72187C-0.0307672 7.90648 -0.0307672 8.12187 0.0615399 8.27571C0.738458 9.66033 1.75384 10.7988 3.01537 11.6603L1.16922 13.5373C0.953842 13.7526 0.923073 14.0911 1.07692 14.2757L1.72307 14.9219C1.90768 15.1065 2.24614 15.0757 2.46152 14.8296L14.8307 2.46033C15.0768 2.24494 15.1076 1.90648 14.923 1.72187ZM4.61536 7.99889C4.61536 6.12197 6.12304 4.61427 7.99995 4.61427C8.61533 4.61427 9.16917 4.76812 9.66148 5.04504L8.73841 5.96812C8.49225 5.90658 8.2461 5.84504 7.99995 5.84504C6.79996 5.84504 5.84612 6.79889 5.84612 7.99889C5.84612 8.24504 5.90766 8.4912 5.96919 8.73735L5.04612 9.66043C4.7692 9.16812 4.61536 8.61427 4.61536 7.99889Z",fill:"#AEAEAE"}):E.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.9385 7.72338C14.4923 4.8003 11.4769 2.76953 8 2.76953C4.52308 2.76953 1.50769 4.8003 0.0615403 7.72338C-0.0307674 7.90799 -0.0307674 8.12338 0.0615403 8.27722C1.50769 11.2003 4.52308 13.2311 8 13.2311C11.4769 13.2311 14.4923 11.2003 15.9385 8.27722C16.0308 8.09261 16.0308 7.90799 15.9385 7.72338ZM8 11.3845C6.12308 11.3845 4.61539 9.87677 4.61539 7.99985C4.61539 6.12293 6.12308 4.61523 8 4.61523C9.87693 4.61523 11.3846 6.12293 11.3846 7.99985C11.3846 9.87677 9.87693 11.3845 8 11.3845ZM7.99989 5.84664C6.79989 5.84664 5.84604 6.80049 5.84604 8.00049C5.84604 9.20049 6.79989 10.1543 7.99989 10.1543C9.19989 10.1543 10.1537 9.20049 10.1537 8.00049C10.1537 6.80049 9.19989 5.84664 7.99989 5.84664Z",fill:"#AEAEAE"})})})]})]})},$ye=()=>(q.useEffect(()=>{window.parent.postMessage({message:{sender:"PdfEditor",query:"pdf-failed-to-open",action:"pdf-failed-to-open",data:{}}},"*")},[]),E.jsx(hl,{onRequestClose:()=>{},prompt:"error",title:"Error opening the pdf",isOpen:!0,children:E.jsx("div",{style:{padding:"1em"},children:"There is no file associated with this record. Please delete this record and upload the file again."})})),ebe=()=>{var P,R,T;const[t,e]=ht(),r=q.useRef(null),n=q.useRef(null),[i,o]=q.useState(!1),[a,s]=q.useState(!1),[l,u]=q.useState(!1),[c,f]=q.useState(!1),[d,h]=q.useState(0),p=q.useRef(0),g=t.windowFocusedPage,w=t.pageControllerFocusedPage??0,[b,y]=q.useState([0,1,2,3,4,5,6,7,8,9]),[x,C]=q.useState([]);function S(k){e(B=>({...B,lastMousePosition:{x:k.clientX,y:k.clientY}}))}async function _(){var G,Q,$,z,X,se;if(p.current++,p.current>1){o(!0);return}u(!0);const k={email:(Q=(G=t==null?void 0:t.sfData)==null?void 0:G.loggedUser)==null?void 0:Q.email,identifier:(z=($=t==null?void 0:t.sfData)==null?void 0:$.docListEntry)==null?void 0:z.Identifier__c},j=await(await fetch(`https://${(X=t==null?void 0:t.sfData)==null?void 0:X.url}/api/pdf/repair`,{method:"POST",body:JSON.stringify(k),headers:{authorization:`Bearer ${(se=t==null?void 0:t.sfData)==null?void 0:se.apiToken}`,"Content-Type":"application/json"}})).json();if(j!=null&&j.error){alert((j==null?void 0:j.error)??"Error repairing the document"),u(!1);return}(j==null?void 0:j.status)==="success"?setTimeout(()=>{A(),u(!1)},4e3):(window.parent.postMessage({message:{sender:"PdfEditor",query:"pdf-failed-to-open",action:"pdf-failed-to-open",data:{}}},"*"),o(!0))}const A=async()=>{var Q,$,z,X,se,ie,Z,te,J,ae,xe,Ae,ve;n.current=!0,console.log("querynng to server");const k={pdfURL:($=(Q=t==null?void 0:t.sfData)==null?void 0:Q.docListEntry)==null?void 0:$.Document__c,email:(X=(z=t==null?void 0:t.sfData)==null?void 0:z.loggedUser)==null?void 0:X.email,action:"initial - pdf load",app:"pdf-editor-sf"};let B;try{const he=(ie=(se=t==null?void 0:t.sfData)==null?void 0:se.docListEntry)==null?void 0:ie.Identifier__c,fe=(te=(Z=t==null?void 0:t.sfData)==null?void 0:Z.docListEntryPage)==null?void 0:te.Identifier__c,Me=fe?`api/generate/presigned-url/${he}/${fe}`:`api/generate/presigned-url/${he}`;console.log("Identifier",he),console.log("PageIdentifier",fe);const me=await(await fetch(`https://${(J=t==null?void 0:t.sfData)==null?void 0:J.url}/${Me}`,{method:"POST",body:JSON.stringify(k),headers:{authorization:`Bearer ${(ae=t==null?void 0:t.sfData)==null?void 0:ae.apiToken}`,"Content-Type":"application/json"}})).json();if(me!=null&&me.error)throw new Error(me==null?void 0:me.error);B=await(await fetch((xe=me==null?void 0:me.data)==null?void 0:xe.url)).arrayBuffer()}catch(he){if(console.log(he),he.message==="No files found for the given identifier"){s(!0);return}}let j;try{j=await ds.load(B,{ignoreEncryption:!0,throwOnInvalidObject:!0})}catch(he){if(console.log(he),(p==null?void 0:p.current)>1)return;await _();return}let G;try{j!=null&&j.save?G=await j.save({ignoreEncryption:!0}):o(!0)}catch{o(!0)}try{const fe=await A9({data:G}).promise,Me=[];for(let le=1;le<=fe.numPages;le++)Me.push(fe.getPage(le));const pt=await Promise.all(Me);o(!1);const me=(Ae=t==null?void 0:t.annotations)!=null&&Ae.length?[...t==null?void 0:t.annotations,...Array(pt==null?void 0:pt.length).fill([])]:Array(pt.length).fill([]),Pe=(ve=t==null?void 0:t.comments)!=null&&ve.length?[...t==null?void 0:t.comments,...Array(pt==null?void 0:pt.length).fill([])]:Array(pt.length).fill([]);e(le=>({...le,originalPdfBytes:G,PDFDocumentLoaded:j,pdfjsLoaded:fe,pdfPages:pt,annotations:me,comments:Pe})),window.parent.postMessage({message:{action:"pdf-success-on-open",sender:"PdfEditor",data:{}}})}catch{o(!0)}};return q.useLayoutEffect(()=>(n!=null&&n.current||A(),document.addEventListener("mousedown",S),()=>{var k;(k=t.pdfjsLoaded)==null||k.destroy(),document.removeEventListener("mousedown",S),document.removeEventListener("mouseenter",S)}),[]),q.useEffect(()=>{let k=0;g>w&&(k=g),w>g&&(k=w);const B=b.at(-1);B-k<5&&(h(Math.random()),y(j=>{const G=[...j];for(let Q=1;Q<6;Q++)G.push(B+Q);return OH(G)}))},[g,w]),q.useEffect(()=>{const k=x.sort((B,j)=>B-j);console.log(k),k.length>0&&e(B=>({...B,windowFocusedPage:k[0]}))},[x]),E.jsxs("div",{style:{width:"max-content",height:"auto",display:"flex",flexDirection:"column",alignItems:"center",gap:"2em",margin:"0 auto",padding:"0 2em"},ref:r,children:[a&&E.jsx($ye,{}),i&&E.jsx(Jye,{fetchPdf:A}),(R=(P=t==null?void 0:t.pdfPages)==null?void 0:P.filter((k,B)=>b==null?void 0:b.includes(B)))==null?void 0:R.map((k,B)=>{var j;return E.jsx(yye,{page:k,pageIndex:B,setPagesInsideViewport:C},(j=k==null?void 0:k._pageInfo)==null?void 0:j.refStr)}),E.jsx(eye,{}),E.jsx(tye,{ctx:t}),!((T=t==null?void 0:t.selectedAnnotation)!=null&&T.Id)&&E.jsx(rye,{selectedAnnotation:t.selectedAnnotation}),E.jsx(iye,{}),E.jsx(bye,{ctx:t,dispatch:e}),E.jsx(Qye,{saveVersion:t==null?void 0:t.saveVersion,annotations:t==null?void 0:t.annotations,comments:t==null?void 0:t.comments,PDFDocumentLoaded:t==null?void 0:t.PDFDocumentLoaded,saveSuccess:t==null?void 0:t.saveSuccess,sfData:t==null?void 0:t.sfData}),(t==null?void 0:t.lockPdf)&&E.jsx(o3,{}),l&&E.jsx(o3,{message:"Fixing PDF please wait..."})]})},tbe="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10.6161%201.84619H1.38537C1.13152%201.84619%200.923828%202.05388%200.923828%202.30773V9.69235C0.923828%209.94619%201.13152%2010.1539%201.38537%2010.1539H10.6161C10.87%2010.1539%2011.0777%209.94619%2011.0777%209.69235V2.30773C11.0777%202.05388%2010.87%201.84619%2010.6161%201.84619ZM10.1546%209.23058H1.84691V2.76904H10.1546V9.23058ZM4.84693%208.76893H2.56231C2.42385%208.76893%202.33154%208.67662%202.33154%208.53816V3.46124C2.33154%203.32278%202.42385%203.23047%202.56231%203.23047H4.84693C4.98539%203.23047%205.0777%203.32278%205.0777%203.46124V8.53816C5.0777%208.67662%204.98539%208.76893%204.84693%208.76893Z'%20fill='%23747474'%20/%3e%3c/svg%3e",rbe="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M0.923828%201.84619H11.0777V10.1539H0.923828V1.84619ZM1.84691%202.76904V9.23058H10.1546V2.76904H1.84691ZM6.92383%203.23047H9.69306V8.76893H6.92383V3.23047Z'%20fill='%23747474'%20/%3e%3c/svg%3e",x_=({position:t="left",column:e})=>{const[,r]=ht(),n=()=>{r(i=>{const o=new Set(Array.from(i.columns));return o.has(e)?o.delete(e):o.add(e),{...i,columns:o}})};return E.jsx("button",{style:{padding:"3px",border:"1px solid #747474",backgroundColor:"#FFFFFF",borderRadius:"4px",width:"27.5px"},onClick:n,children:E.jsx("img",{src:t==="left"?tbe:rbe})})};x_.propTypes={position:m.string,column:m.number.isRequired};const nbe=()=>{var e,r;const[t]=ht();return q.useEffect(()=>{var n,i;(n=t==null?void 0:t.pdfPages)!=null&&n.length&&window.parent.postMessage({message:{sender:"PdfEditor",query:"document-page-count",action:"document-page-count",data:{pageCount:(i=t==null?void 0:t.pdfPages)==null?void 0:i.length}}},"*")},[(e=t==null?void 0:t.pdfPages)==null?void 0:e.length]),q.useEffect(()=>{var n,i,o;!((n=t==null?void 0:t.pdfPages)!=null&&n.length)||(o=(i=t==null?void 0:t.sfData)==null?void 0:i.docListEntry)!=null&&o.MasterDocument__c||window.parent.postMessage({message:{sender:"PdfEditor",query:"master-page-focus",action:"master-page-focus",data:{page:(t==null?void 0:t.windowFocusedPage)-1}}},"*")},[t==null?void 0:t.windowFocusedPage]),E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5em"},children:[E.jsx("p",{style:{fontSize:"14px",width:"22px",height:"22px",backgroundColor:"#444444",color:"#fff",display:"flex",justifyContent:"center",borderRadius:"2px"},children:t==null?void 0:t.windowFocusedPage}),E.jsx("p",{children:"/"}),E.jsx("p",{style:{fontSize:"14px",height:"22px"},children:(r=t==null?void 0:t.pdfPages)==null?void 0:r.length})]})},ibe=t=>E.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:E.jsx("path",{d:"M7.91018 7.02988L1.43018 13.5199L7.92018 19.9999L14.4102 13.5199L7.91018 7.02988ZM4.26018 13.5199L7.92018 9.85988L11.5702 13.5199L7.91018 17.1799L4.26018 13.5199ZM19.9302 7.25988C18.1802 5.49988 15.8702 4.61988 13.5702 4.61988V1.37988L9.33018 5.61988L13.5702 9.85988V6.61988C15.3602 6.61988 17.1502 7.29988 18.5202 8.66988C21.2502 11.3999 21.2502 15.8399 18.5202 18.5699C17.1502 19.9399 15.3602 20.6199 13.5702 20.6199C12.6002 20.6199 11.6302 20.4099 10.7302 20.0099L9.24018 21.4999C10.5902 22.2399 12.0802 22.6199 13.5702 22.6199C15.8702 22.6199 18.1802 21.7399 19.9302 19.9799C23.4502 16.4699 23.4502 10.7699 19.9302 7.25988Z",fill:"#747474"})}),obe=t=>E.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:E.jsx("path",{d:"M1.5 13.5C1.5 18.47 5.53 22.5 10.5 22.5C12.26 22.5 13.9 21.99 15.29 21.12L13.83 19.66C12.84 20.19 11.7 20.5 10.5 20.5C6.64 20.5 3.5 17.36 3.5 13.5C3.5 9.64 6.64 6.5 10.5 6.5H10.67L9.09 8.09L10.5 9.5L14.5 5.5L10.5 1.5L9.08 2.91L10.67 4.5H10.5C5.53 4.5 1.5 8.53 1.5 13.5ZM10.5 13.5L16.5 19.5L22.5 13.5L16.5 7.5L10.5 13.5ZM16.5 16.67L13.33 13.5L16.5 10.33L19.67 13.5L16.5 16.67Z",fill:"#747474"})}),abe=()=>{var p,g,w;const[t,e]=q.useState(!1),[r,n]=ht(),[i,o]=q.useState(!1),[a,s]=q.useState(null),l=r==null?void 0:r.PDFDocumentLoaded,u=((p=r==null?void 0:r.annotations.at((r==null?void 0:r.windowFocusedPage)-1))==null?void 0:p.length)>0,c=((w=(g=r==null?void 0:r.comments)==null?void 0:g.at((r==null?void 0:r.windowFocusedPage)-1))==null?void 0:w.length)>0,f=!u&&!c,d=r.isMasterDoc;async function h(b=!0){var y,x,C,S,_,A,P;if(d){const R=r.sfData.masterDocumentPages.at(r.windowFocusedPage-1),T={identifier:`${(x=(y=R==null?void 0:R.Original_Document_Page__r)==null?void 0:y.Parent__r)==null?void 0:x.Identifier__c}/${(C=R==null?void 0:R.Original_Document_Page__r)==null?void 0:C.Identifier__c}`,rotationDegrees:b?90:-90},k=await fetch(`https://${(S=r==null?void 0:r.sfData)==null?void 0:S.url}/api/pdf/page/rotate`,{method:"POST",body:JSON.stringify(T),headers:{authorization:`Bearer ${(_=r==null?void 0:r.sfData)==null?void 0:_.apiToken}`,"Content-Type":"application/json"}});window.parent.postMessage({message:{sender:"PdfEditor",query:"master-doc-page-rotate",action:"master-doc-page-rotate",data:{page:R==null?void 0:R.Id}}},"*"),console.log(k,"rotateREs")}if(r!=null&&r.windowFocusedPage){const R=r.PDFDocumentLoaded.getPage(Number(r.windowFocusedPage)-1),T=R.getRotation().angle,k=b?T+90:T-90;R.setRotation(Ke(k));const B=((A=r==null?void 0:r.annotations)==null?void 0:A.at(Number(r.windowFocusedPage)-1))||[],j=((P=r==null?void 0:r.comments)==null?void 0:P.at(Number(r.windowFocusedPage)-1))||[];window.parent.postMessage({message:{sender:"PdfEditor",query:"annotation-delete",action:"annotation-delete",data:{annotations:[...B,...j].map(ie=>ie==null?void 0:ie.Id)}}},"*");const G=await ds.load(await r.PDFDocumentLoaded.save()),Q=await G.save(),z=await A9({data:Q}).promise,X=[];for(let ie=1;ie<=z.numPages;ie++)X.push(z.getPage(ie));const se=await Promise.all(X);o(!1),e(!1),n(ie=>({...ie,originalPdfBytes:Q,PDFDocumentLoaded:G,pdfjsLoaded:z,pdfPages:se,saveVersion:new Date().getTime()}))}}return E.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"1em",cursor:l?"pointer":"not-allowed"},children:[E.jsx(obe,{style:{cursor:l?"pointer":"not-allowed"},onClick:()=>{if(f){h(!0);return}e(!0),s(!0)}}),E.jsx(ibe,{style:{cursor:"pointer"},onClick:()=>{if(f){h(!1);return}s(!1),e(!0)}}),E.jsx(hl,{ariaHideApp:!1,prompt:"error",onRequestClose:()=>e(!1),heading:"Rotate Page",isOpen:t,footer:[E.jsx(Nt,{disabled:i,label:"Cancel",onClick:()=>e(!1)},"1"),E.jsx(Nt,{disabled:i,label:"Rotate",variant:"destructive",onClick:()=>{o(!0),h(a)}},"2")],children:E.jsx("p",{style:{fontSize:"16px",padding:"1em"},children:"Are you sure you want to rotate the page? This will delete all the annotations and comments from the page."})})]})},sbe=({onClick:t=()=>{}})=>E.jsx("svg",{onClick:t,style:{cursor:"pointer"},width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{d:"M5 12H19",stroke:"#747474",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),lbe=({onClick:t=()=>{}})=>E.jsx("svg",{onClick:t,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",cursor:"pointer",children:E.jsx("path",{d:"M12 6V12M12 12V18M12 12H18M12 12L6 12",stroke:"#747474",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),ube=()=>{const[t,e]=ht();function r(n=!0){let i=t.pdfScale;n?i+=.3:i-=.3;const o=document.getElementById("pdf-pages-container"),a=(o==null?void 0:o.scrollTop)/(o==null?void 0:o.scrollHeight),s=(o==null?void 0:o.scrollLeft)/(o==null?void 0:o.scrollWidth);e(l=>({...l,pdfScale:i<.3?.3:i>3?3:i})),setTimeout(()=>{o.scrollTop=a*(o==null?void 0:o.scrollHeight),o.scrollLeft=s*(o==null?void 0:o.scrollWidth)},50)}return E.jsxs("div",{style:{display:"flex",justifyContet:"center",alignItems:"center",gap:"1em"},children:[E.jsx(sbe,{onClick:()=>r(!1)}),E.jsxs("p",{style:{height:"32px",width:"60px",borderRadius:"4px",border:"1px solid #747474",backgroundColor:"white",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"13px"},children:[Math.round(t.pdfScale/1.5*100),"%"]}),E.jsx(lbe,{onClick:()=>r(!0)})]})},cbe=()=>{var c,f,d,h;const[t,e]=ht(),[r,n]=q.useState(!1),[i,o]=q.useState(!1),[a,s]=q.useState(!1),l=(f=(c=t==null?void 0:t.sfData)==null?void 0:c.docListEntry)==null?void 0:f.MasterDocument__c;async function u(p=[]){var S,_,A,P,R,T;if(l)return;const g=(S=t==null?void 0:t.pdfPages)==null?void 0:S.filter((k,B)=>!p.includes(B+1)),w=(A=(_=t==null?void 0:t.annotations)==null?void 0:_.filter((k,B)=>!p.includes(B+1)))==null?void 0:A.map((k,B)=>k==null?void 0:k.map(j=>({...j,Page__c:B+1}))),b=(R=(P=t==null?void 0:t.comments)==null?void 0:P.filter((k,B)=>!p.includes(B+1)))==null?void 0:R.map((k,B)=>k==null?void 0:k.map(j=>({...j,Page__c:B+1}))),y=t.PDFDocumentLoaded,x=(T=p==null?void 0:p.sort((k,B)=>k-B))==null?void 0:T.map((k,B)=>k-B);console.log(x),x.forEach(k=>{y.removePage(k-1)});const C=y.save();e(k=>({...k,pdfPages:g,PDFDocumentLoaded:y,windowFocusedPage:p.at(0),originalPdfBytes:C,annotations:w,comments:b,shiftPages:[],saveVersion:Math.random()})),setTimeout(()=>{n(!1),o(!0),s(!1)},1e3)}return q.useEffect(()=>{function p(g){g.key==="Backspace"&&(g!=null&&g.ctrlKey)&&n(!0)}return window.addEventListener("keydown",p),()=>{window.removeEventListener("keydown",p)}},[]),E.jsxs(E.Fragment,{children:[!l&&E.jsx(M7,{onClick:()=>{a||n(!r)}}),i&&E.jsx(Ay,{children:E.jsx(qp,{duration:1500,variant:"success",labels:{heading:"Page deleted successfully"},onRequestClose:()=>o(!1)})}),E.jsx(hl,{ariaHideApp:!1,prompt:"error",onRequestClose:()=>n(!1),heading:"Delete Page",isOpen:r,footer:[E.jsx(Nt,{disabled:a,label:"Cancel",onClick:()=>n(!1)},"1"),E.jsx(Nt,{disabled:a,label:"Delete",variant:"destructive",onClick:()=>{var g;s(!0);const p=(g=t==null?void 0:t.shiftPages)!=null&&g.length?t.shiftPages:[t==null?void 0:t.windowFocusedPage];u(p)}},"2")],children:E.jsxs("p",{style:{fontSize:"16px",padding:"1em"},children:["Are you sure you want to delete page"," ",(d=t==null?void 0:t.shiftPages)!=null&&d.length?(h=t==null?void 0:t.shiftPages)==null?void 0:h.join(", "):t.windowFocusedPage,"? This action is permanent and cannot be undone. Please confirm to proceed."]})})]})},fbe=({onClick:t=()=>{}})=>E.jsx("svg",{onClick:t,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{d:"M10.7996 21.5998H5.9996C4.67411 21.5998 3.5996 20.5253 3.59961 19.1998L3.5997 4.79989C3.59971 3.47441 4.67422 2.3999 5.9997 2.3999H16.8C18.1255 2.3999 19.2 3.47442 19.2 4.7999V11.3999M15.6 18.0425L18.0543 15.5999M18.0543 15.5999L20.4 17.9321M18.0543 15.5999V21.5999",stroke:"#747474",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),dbe=({open:t,setOpen:e})=>{const[r,n]=q.useState("All Pages"),[i]=ht(),[o,a]=q.useState(""),[s,l]=q.useState(""),[u,c]=q.useState(""),[f,d]=q.useState(""),[h,p]=q.useState(!1);function g(){if(r==="Range")return!o||!s||o>s;if(r==="Custom")return u?u.split(",").some(y=>isNaN(Number(y))):!0;if(!f)return!0}function w(){var C,S;let y=[];r==="All Pages"&&new Array((C=i==null?void 0:i.pdfPages)==null?void 0:C.length).fill(0).forEach((_,A)=>y.push(A+1)),r==="Range"&&new Array(s-o+1).fill(0).forEach((_,A)=>y.push(o+A)),r==="Custom"&&(y=OH(u.split(",").map(_=>Number(_))));const x=i==null?void 0:i.annotations.filter((_,A)=>y.includes(A+1)).reduce((_,A)=>_.concat(A),[]);window.parent.postMessage({message:{sender:"PdfEditor",action:"extractPages-docEntry",data:{pages:y,pdfName:f??`extracted pages ${new Date().getTime()}`,docListEntry:(S=i==null?void 0:i.sfData)==null?void 0:S.docListEntry,annotations:x}}},"*"),p(!0),e(!1),setTimeout(()=>{p(!1)},5e3)}const b=y=>{const x=document.activeElement;if(y.key==="Tab"&&x){const C=document.querySelector(`#current-range-${x.id.includes("one")?"two":"one"}-input`);C&&C.focus()}};return q.useEffect(()=>{var y,x;(y=i==null?void 0:i.shiftPages)!=null&&y.length&&t&&(n("Custom"),c((x=i==null?void 0:i.shiftPages)==null?void 0:x.join(",")))},[t]),q.useEffect(()=>(window.addEventListener("keydown",b),()=>{window.removeEventListener("keydown",b)}),[]),E.jsxs(E.Fragment,{children:[E.jsx(Ay,{children:h&&E.jsx(qp,{duration:5e3,labels:{heading:[E.jsx("strong",{children:f},"a")," Extracted Successfully"]},variant:"success"})}),E.jsx(hl,{title:"Extract Pages",onRequestClose:()=>e(!1),isOpen:t,footer:[E.jsx(Nt,{label:"Cancel",onClick:()=>e(!1)},"1"),E.jsx(Nt,{disabled:g(),label:"Extract",variant:"brand",onClick:()=>w()},"2")],children:E.jsxs("div",{style:{padding:"2em 1em"},children:[E.jsx("p",{children:"Select pages to extract"}),E.jsxs(Sy,{onChange:y=>n(y.target.value),children:[E.jsx(Lc,{tabIndex:"0",checked:r==="All Pages",value:"All Pages",label:"All Pages"}),E.jsx(Lc,{tabindex:"1",checked:r==="Range",value:"Range",label:"Range"}),E.jsx("div",{style:{marginBottom:"10px",marginTop:"5px"},children:r==="Range"&&E.jsxs("div",{style:{display:"flex",alignContent:"center",gap:".5em",marginTop:"1em"},children:[E.jsx("p",{style:{margin:0,display:"flex",alignItems:"center"},children:"From"}),E.jsx(Ai,{id:"current-range-one-input",type:"text",styleInput:{width:"50px"},onChange:y=>{a(Number(y.target.value)),y.stopPropagation()}}),E.jsx("p",{style:{margin:0,display:"flex",alignItems:"center"},children:"to"}),E.jsx(Ai,{id:"current-range-two-input",type:"text",styleInput:{width:"50px"},onChange:y=>{l(Number(y.target.value)),y.stopPropagation()}})]})}),E.jsx(Lc,{tabindex:"2",checked:r==="Custom",value:"Custom",label:"Custom"}),E.jsx("div",{children:r==="Custom"&&E.jsx("div",{style:{marginTop:"1em"},children:E.jsx(Ai,{value:u,onChange:y=>{y.stopPropagation(),c(y.target.value)},placeholder:"1,2,3,4..."})})})]}),E.jsx("br",{}),E.jsx(Ai,{onChange:y=>d(y.target.value),label:"Document Name"})]})})]})},hbe=()=>{const[t,e]=q.useState(!1);return E.jsxs("div",{children:[E.jsx(fbe,{onClick:()=>e(!0)}),E.jsx(dbe,{open:t,setOpen:e})]})},pbe=()=>E.jsx("svg",{width:"23",height:"23",viewBox:"0 0 23 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.6996 5.26155H15.0534C15.3303 5.26155 15.5611 5.03078 15.5611 4.75385C15.5611 4.61539 15.5149 4.52308 15.4226 4.38462L12.0996 1.1077C12.0073 1.01539 11.9149 0.969238 11.7765 0.969238C11.4996 0.969238 11.2688 1.20001 11.2688 1.47693V3.83078C11.2688 4.61539 11.9149 5.26155 12.6996 5.26155ZM10.8534 18.7385C10.8534 15.6 12.7918 12.9231 15.5611 11.8615V8.12308C15.5611 7.7077 15.238 7.38462 14.8226 7.38462H11.2226C10.0226 7.38462 9.05337 6.41539 9.05337 5.26155V1.66155C9.09952 1.29232 8.77644 0.969238 8.36106 0.969238H2.63798C1.43798 0.969238 0.46875 1.93847 0.46875 3.09232V16.6615C0.46875 17.8615 1.43798 18.7846 2.63798 18.7846H10.8534V18.7385ZM14.1764 15.9693L16.9457 18.7385L14.1764 21.5077C13.8995 21.7846 13.8995 22.2462 14.1764 22.4769L14.4995 22.8C14.7764 23.0769 15.238 23.0769 15.4687 22.8L18.238 20.0308L21.0072 22.8C21.2841 23.0769 21.7456 23.0769 21.9764 22.8L22.2995 22.4769C22.5764 22.2 22.5764 21.7385 22.2995 21.5077L19.5303 18.7385L22.2995 15.9693C22.5764 15.6923 22.5764 15.2308 22.2995 15L21.9764 14.6769C21.6995 14.4 21.238 14.4 21.0072 14.6769L18.238 17.4462L15.4687 14.6769C15.1918 14.4 14.7303 14.4 14.4995 14.6769L14.1764 15C13.8995 15.2308 13.8995 15.6923 14.1764 15.9693Z",fill:"#747474"})}),vbe=()=>{const[t,e]=q.useState(!1),[r,n]=q.useState(!1);return E.jsxs(E.Fragment,{children:[E.jsx(po,{isOpen:r,content:"Remove Classification",dialogClassName:"pop-over-z100",align:"bottom",children:E.jsx("div",{tabIndex:0,onClick:i=>{i.stopPropagation(),e(!0)},children:E.jsx("a",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:E.jsx(pbe,{})})})}),t&&E.jsx(AH,{onClose:()=>e(!1)})]})},gbe=()=>{const[t]=ht();return E.jsxs("div",{onClick:e=>e.stopPropagation(),style:{height:"48px",backgroundColor:"#D9D9D9",width:"100%",display:"flex",padding:"0 15px",alignItems:"center",justifyContent:"center",gap:"8em",minHeight:"48px",position:"relative",zIndex:999},children:[E.jsx("div",{style:{position:"absolute",left:"10px"},children:E.jsx(x_,{position:"left",column:0})}),E.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"5em"},children:[E.jsx(nbe,{}),E.jsx(ube,{}),E.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"1em"},children:[E.jsx(abe,{}),!(t!=null&&t.isMasterDoc)&&E.jsx(hbe,{}),(t==null?void 0:t.isMasterDoc)&&E.jsx(vbe,{}),E.jsx(cbe,{})]}),E.jsx("div",{style:{position:"absolute",right:"10px"},children:E.jsx(x_,{position:"right",column:1})})]})]})},mbe=()=>{const[t,e]=ht(),[r,n]=q.useState(!1);return E.jsx(po,{isOpen:r,content:"Freehand",dialogClassName:"pop-over-z100",align:"bottom",children:E.jsx("a",{children:E.jsx("svg",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:()=>e(i=>({...i,activeMode:"draw",selectedAnnotation:null})),width:"24",height:"24",viewBox:"0 0 24 24",fill:t.activeMode==="draw"||r?"#A5A5A5":"none",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{d:"M11.9999 22.1999H21.5999M14.9999 4.7999L19.1999 8.3999M4.1999 15.5999L16.0313 3.35533C17.3052 2.08143 19.3706 2.08143 20.6445 3.35533C21.9184 4.62923 21.9184 6.69463 20.6445 7.96853L8.3999 19.7999L2.3999 21.5999L4.1999 15.5999Z",stroke:"#444444",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})})},ybe=()=>{const[t,e]=ht(),[r,n]=q.useState(!1);return E.jsx(po,{isOpen:r,content:"Stamp",dialogClassName:"pop-over-z100",align:"bottom",children:E.jsx("a",{children:E.jsx("svg",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),id:"2",style:{cursor:"pointer",userSelect:"none"},onClick:()=>e(i=>({...i,activeMode:"checkmark",repaintAnnotations:Math.random()})),width:"24",height:"24",viewBox:"0 0 24 24",fill:t.activeMode==="checkmark"||r?"#A5A5A5":"none",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{d:"M9 12L11 14L15.5 9.5M7.33377 3.8187C8.1376 3.75455 8.90071 3.43846 9.51447 2.91542C10.9467 1.69486 13.0533 1.69486 14.4855 2.91542C15.0993 3.43846 15.8624 3.75455 16.6662 3.8187C18.5421 3.96839 20.0316 5.45794 20.1813 7.33377C20.2455 8.1376 20.5615 8.90071 21.0846 9.51447C22.3051 10.9467 22.3051 13.0533 21.0846 14.4855C20.5615 15.0993 20.2455 15.8624 20.1813 16.6662C20.0316 18.5421 18.5421 20.0316 16.6662 20.1813C15.8624 20.2455 15.0993 20.5615 14.4855 21.0846C13.0533 22.3051 10.9467 22.3051 9.51447 21.0846C8.90071 20.5615 8.1376 20.2455 7.33377 20.1813C5.45794 20.0316 3.96839 18.5421 3.8187 16.6662C3.75455 15.8624 3.43846 15.0993 2.91542 14.4855C1.69486 13.0533 1.69486 10.9467 2.91542 9.51447C3.43846 8.90071 3.75455 8.1376 3.8187 7.33377C3.96839 5.45794 5.45794 3.96839 7.33377 3.8187Z",stroke:"#444444",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})})},bbe=()=>{const[t,e]=ht(),[r,n]=q.useState(!1);return E.jsx(po,{isOpen:r,content:"Text box",dialogClassName:"pop-over-z100",align:"bottom",children:E.jsx("a",{children:E.jsx("svg",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:()=>{e(i=>({...i,activeMode:"text",drawCanvasClick:null}))},width:"24",height:"24",viewBox:"0 0 24 24",fill:t.activeMode==="text"||r?"#A5A5A5":"none",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{d:"M8 7H16M12 7V17M7.8 21H16.2C17.8802 21 18.7202 21 19.362 20.673C19.9265 20.3854 20.3854 19.9265 20.673 19.362C21 18.7202 21 17.8802 21 16.2V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V16.2C3 17.8802 3 18.7202 3.32698 19.362C3.6146 19.9265 4.07354 20.3854 4.63803 20.673C5.27976 21 6.11984 21 7.8 21Z",stroke:"#444444",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})})},xbe=()=>{const[t,e]=ht(),[r,n]=q.useState(!1);return E.jsx(po,{isOpen:r,content:"Comment",dialogClassName:"pop-over-z100",align:"bottom",children:E.jsx("a",{children:E.jsx("svg",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:()=>e(i=>({...i,activeMode:"comments",showComments:!0})),width:"24",height:"24",viewBox:"0 0 24 24",fill:(t==null?void 0:t.activeMode)==="comments"||r?"#A5A5A5":"none",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{d:"M7 8.5H12M7 12H15M7 18V20.3355C7 20.8684 7 21.1348 7.10923 21.2716C7.20422 21.3906 7.34827 21.4599 7.50054 21.4597C7.67563 21.4595 7.88367 21.2931 8.29976 20.9602L10.6852 19.0518C11.1725 18.662 11.4162 18.4671 11.6875 18.3285C11.9282 18.2055 12.1844 18.1156 12.4492 18.0613C12.7477 18 13.0597 18 13.6837 18H16.2C17.8802 18 18.7202 18 19.362 17.673C19.9265 17.3854 20.3854 16.9265 20.673 16.362C21 15.7202 21 14.8802 21 13.2V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V14C3 14.93 3 15.395 3.10222 15.7765C3.37962 16.8117 4.18827 17.6204 5.22354 17.8978C5.60504 18 6.07003 18 7 18Z",stroke:"#444444",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})})},wbe=({style:t,fill:e="none"})=>E.jsxs("svg",{style:{...t},width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[E.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.82881 3.15757C10.0888 2.20235 10.9624 1.5 12 1.5C13.0376 1.5 13.9112 2.20235 14.1712 3.15757C14.4277 3.05589 14.7073 3 15 3C16.2426 3 17.25 4.00736 17.25 5.25V6.12803C17.4846 6.04512 17.737 6 18 6C19.2426 6 20.25 7.00736 20.25 8.25V14.5083C20.25 15.944 19.8753 17.3549 19.163 18.6014L17.799 20.9884C17.2649 21.9231 16.2708 22.5 15.1943 22.5H9.40789C8.43904 22.5 7.52982 22.0321 6.96669 21.2437L4.7279 18.1094C4.0919 17.219 3.75 16.1521 3.75 15.0579V10.5C3.75 9.25736 4.75736 8.25 6 8.25C6.26298 8.25 6.51542 8.29512 6.75 8.37803V5.25C6.75 4.00736 7.75736 3 9 3C9.29269 3 9.57232 3.05589 9.82881 3.15757Z",fill:e}),E.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.82881 3.15757C10.0888 2.20235 10.9624 1.5 12 1.5C13.0376 1.5 13.9112 2.20235 14.1712 3.15757C14.4277 3.05589 14.7073 3 15 3C16.2426 3 17.25 4.00736 17.25 5.25V6.12803C17.4846 6.04512 17.737 6 18 6C19.2426 6 20.25 7.00736 20.25 8.25V14.5083C20.25 15.944 19.8753 17.3549 19.163 18.6014L17.799 20.9884C17.2649 21.9231 16.2708 22.5 15.1943 22.5H9.40789C8.43904 22.5 7.52982 22.0321 6.96669 21.2437L4.7279 18.1094C4.0919 17.219 3.75 16.1521 3.75 15.0579V10.5C3.75 9.25736 4.75736 8.25 6 8.25C6.26298 8.25 6.51542 8.29512 6.75 8.37803V5.25C6.75 4.00736 7.75736 3 9 3C9.29269 3 9.57232 3.05589 9.82881 3.15757ZM11.25 10.5C11.25 10.9142 10.9142 11.25 10.5 11.25C10.0858 11.25 9.75 10.9142 9.75 10.5V5.25C9.75 4.83579 9.41421 4.5 9 4.5C8.58579 4.5 8.25 4.83579 8.25 5.25V13.5C8.25 13.9142 7.91421 14.25 7.5 14.25C7.08579 14.25 6.75 13.9142 6.75 13.5V10.5C6.75 10.0858 6.41421 9.75 6 9.75C5.58579 9.75 5.25 10.0858 5.25 10.5V15.0579C5.25 15.8395 5.49421 16.6015 5.9485 17.2376L8.18729 20.3719C8.46886 20.7661 8.92346 21 9.40789 21H15.1943C15.7326 21 16.2296 20.7116 16.4966 20.2442L17.8606 17.8572C18.4434 16.8373 18.75 15.6829 18.75 14.5083V8.25C18.75 7.83579 18.4142 7.5 18 7.5C17.5858 7.5 17.25 7.83579 17.25 8.25V11.25C17.25 11.6642 16.9142 12 16.5 12C16.0858 12 15.75 11.6642 15.75 11.25V5.25C15.75 4.83579 15.4142 4.5 15 4.5C14.5858 4.5 14.25 4.83579 14.25 5.25V10.5C14.25 10.9142 13.9142 11.25 13.5 11.25C13.0858 11.25 12.75 10.9142 12.75 10.5V3.75C12.75 3.33579 12.4142 3 12 3C11.5858 3 11.25 3.33579 11.25 3.75V10.5Z",fill:"#444444"})]}),Cbe=()=>{const[t,e]=ht(),[r,n]=q.useState(!1);return E.jsx(po,{isOpen:r,content:"Hand",dialogClassName:"pop-over-z100",align:"bottom",children:E.jsx("a",{children:E.jsx("div",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:()=>{document.body.style.cursor="grab",e(i=>({...i,activeMode:"hand",selectedAnnotation:null}))},children:E.jsx(wbe,{fill:r||t.activeMode==="hand"?"#A5A5A5":"none",style:{height:"24px",width:"24px"}})})})})},Sbe=()=>{const[t,e]=ht(),[r,n]=q.useState(!1);return E.jsx(po,{isOpen:r,content:"Highlighter",dialogClassName:"pop-over-z100",align:"bottom",children:E.jsx("a",{children:E.jsx("div",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:E.jsx(_H,{fill:r||t.activeMode==="highlight"?"#A5A5A5":"none",width:24,height:24,onClick:()=>e(i=>({...i,activeMode:"highlight"}))})})})})},Ebe=({width:t,height:e,fill:r="none"})=>E.jsx("svg",{width:t,height:e,viewBox:"0 0 24 24",fill:r,xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{d:"M17.9999 2.3999C19.9881 2.3999 21.5999 4.01168 21.5999 5.9999V18C21.5999 19.9882 19.9881 21.6 17.9999 21.6H5.9999C4.01168 21.6 2.3999 19.9882 2.3999 18L2.3999 5.9999C2.3999 4.01168 4.01168 2.3999 5.9999 2.3999L17.9999 2.3999Z",stroke:"#444444",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),_be=()=>{const[t,e]=ht(),[r,n]=q.useState(!1);return E.jsx(po,{isOpen:r,content:"Rectangle",dialogClassName:"pop-over-z100",align:"bottom",children:E.jsx("a",{children:E.jsx("div",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:()=>e(i=>({...i,activeMode:"rectangle"})),children:E.jsx(Ebe,{height:24,width:24,fill:r||t.activeMode==="rectangle"?"#A5A5A5":"none"})})})})},Abe=()=>{const[t,e]=ht();return E.jsxs("div",{style:{display:"flex",gap:".5em"},children:[E.jsx(rf,{value:t!=null&&t.checkmarkColor?t==null?void 0:t.checkmarkColor:(t==null?void 0:t.drawImage)==="greenCheck"?"#34C759":"#FF3B30",hideInput:!0,labels:{},events:{onChange:(r,n)=>{n!=null&&n.isValid&&e(i=>({...i,drawConfig:{...i.drawConfig,checkmarkColor:n.color}}))}}}),E.jsx("div",{style:{padding:"2.5px",...t.drawImage==="greenCheck"?{border:"1px solid rgb(1, 118, 211)"}:{border:"1px solid transparent"}},children:E.jsx("svg",{onClick:()=>{e(r=>({...r,drawImage:"greenCheck",drawConfig:{...r.drawConfig,checkmarkColor:"#34C759"}}))},width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{d:"M20 6L9 17L4 12",stroke:"#34C759",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})}),E.jsx("div",{style:{padding:"2.5px",...t.drawImage==="redX"?{border:"1px solid rgb(1, 118, 211)"}:{border:"1px solid transparent"}},children:E.jsx("svg",{onClick:()=>{e(r=>({...r,drawImage:"redX",drawConfig:{...r.drawConfig,checkmarkColor:"#FF3B30"}}))},width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{d:"M17 7L7 17M7 7L17 17",stroke:"#FF3B30",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})})]})},Obe=()=>{var r,n;const[t,e]=ht();return E.jsxs("div",{style:{display:"flex"},children:[E.jsx(rf,{value:(r=t==null?void 0:t.drawConfig)==null?void 0:r.strokeStyle,hideInput:!0,events:{onChange:(i,o)=>{e(a=>({...a,drawConfig:{...a==null?void 0:a.drawConfig,strokeStyle:o==null?void 0:o.color}}))}}}),E.jsx(Ai,{variant:"counter",styleContainer:{width:"115px"},styleInput:{padding:0},type:"number",minValue:1,value:(n=t==null?void 0:t.drawConfig)==null?void 0:n.lineWidth,onChange:(i,o)=>{e(a=>({...a,drawConfig:{...a==null?void 0:a.drawConfig,lineWidth:Number(o.number)}}))}})]})},zh=10,d8={aspectRatio:"16/9",border:"1px solid gray",borderRadius:"50%"},Pbe=()=>{const[t,e]=ht(),r=t==null?void 0:t.eraserSize;function n(i){e(o=>({...o,eraserSize:i}))}return E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1em"},children:[E.jsx("div",{onClick:()=>n(1),style:{width:`${zh}px`,height:`${zh}px`,backgroundColor:r===1&&"#a0a0a0",...d8}}),E.jsx("div",{onClick:()=>n(2),style:{width:`${zh*2}px`,height:`${zh*2}px`,backgroundColor:r===2&&"#a0a0a0",...d8}}),E.jsx("div",{onClick:()=>n(3),style:{width:`${zh*3}px`,height:`${zh*3}px`,backgroundColor:r===3&&"#a0a0a0",...d8}})]})},Tbe=()=>{const[t,e]=q.useState(!1),[r,n]=ht();return E.jsx(i4,{onClickAway:()=>e(!1),children:E.jsx("div",{children:E.jsx(fL,{menuStyle:{width:"70px"},buttonVariant:"neutral",width:"xx-small",isOpen:t,onClick:()=>e(!t),align:"left",iconCategory:"utility",iconName:"down",iconPosition:"right",className:"font-size-dropdown",label:r.textConfig.fontSize,onSelect:i=>{n(o=>{var a;return{...o,textConfig:{...o.textConfig,fontSize:i==null?void 0:i.value},...o.activeMode==="text"&&((a=r.selectedAnnotation)!=null&&a.Id)?{selectedAnnotation:{...r.selectedAnnotation,TextConfig__c:{...r.selectedAnnotation.TextConfig__c,fontSize:i==null?void 0:i.value}}}:{}}}),e(!1)},options:Array.from({length:10},(i,o)=>o*2+12).map(i=>({label:i.toString(),value:i.toString()}))})})})},kbe=()=>{const[t,e]=q.useState(!1),[r,n]=ht();return E.jsx(i4,{onClickAway:()=>e(!1),children:E.jsx("div",{children:E.jsx(fL,{onOpen:()=>e(!0),className:"font-select-container",iconName:"down",iconPosition:"right",iconCategory:"utility",buttonClassName:"font-select-button",size:"xx-small",buttonVariant:"neutral",width:"xx-small",isOpen:t,onClick:()=>e(!t),align:"left",label:r.textConfig.fontFamily,onSelect:i=>{n(o=>{var a,s;return{...o,textConfig:{...o.textConfig,fontFamily:i==null?void 0:i.value},...o.activeMode==="text"&&((a=o.selectedAnnotation)!=null&&a.Id)&&((s=o.selectedAnnotation)==null?void 0:s.Type__c)==="Text"?{selectedAnnotation:{...r.selectedAnnotation,TextConfig__c:{...r.selectedAnnotation.TextConfig__c,fontFamily:i==null?void 0:i.value}}}:{}}})},options:[{label:"Helvetica",value:"Helvetica"},{label:"Arial",value:"Arial"},{label:"Arial Black",value:"Arial Black"},{label:"Sans serif",value:"sans-serif"}]})})})},Dbe=()=>{var r;const[t,e]=ht();return E.jsx("div",{children:E.jsx(rf,{value:(r=t==null?void 0:t.textConfig)==null?void 0:r.color,hideInput:!0,events:{onChange:(n,i)=>{i!=null&&i.isValid&&e(o=>{var a;return{...o,textConfig:{...o.textConfig,color:i.color},...o.activeMode==="text"&&((a=t.selectedAnnotation)!=null&&a.Id)?{selectedAnnotation:{...t.selectedAnnotation,TextConfig__c:{...t.selectedAnnotation.TextConfig__c,color:i==null?void 0:i.color}}}:{}}})},onWorkingColorChange:n=>{n.stopPropagation()}}})})},Rbe=()=>E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1em"},children:[E.jsx(kbe,{}),E.jsx(Tbe,{}),E.jsx(Dbe,{})]}),Fbe=()=>{var r,n;const[t,e]=ht();return E.jsxs("div",{style:{display:"flex",gap:"1em"},children:[E.jsx(rf,{value:(r=t==null?void 0:t.drawConfig)==null?void 0:r.rectStyle,hideInput:!0,labels:{},events:{onChange:(i,o)=>{o!=null&&o.isValid&&e(a=>({...a,drawConfig:{...a.drawConfig,rectStyle:o.color}}))}}}),E.jsx(Ai,{minValue:1,variant:"counter",styleInput:{padding:0},styleContainer:{width:"115px"},value:(n=t==null?void 0:t.drawConfig)==null?void 0:n.lineWidth,onChange:(i,o)=>{e(a=>({...a,drawConfig:{...a.drawConfig,lineWidth:o==null?void 0:o.value}}))}})]})},Ibe=()=>{var r;const[t,e]=ht();return E.jsx("div",{children:E.jsx(rf,{value:(r=t==null?void 0:t.highlightConfig)==null?void 0:r.strokeStyle,hideInput:!0,events:{onChange:(n,i)=>{console.log(i),!(!i||!i.isValid)&&e(o=>({...o,highlightConfig:{...o==null?void 0:o.highlightConfig,strokeStyle:i==null?void 0:i.color}}))}}})})},Mbe=({active:t})=>E.jsxs("div",{children:[t==="checkmark"&&E.jsx(Abe,{}),t==="erase"&&E.jsx(Pbe,{}),t==="text"&&E.jsx(Rbe,{}),t==="draw"&&E.jsx(Obe,{}),t==="rectangle"&&E.jsx(Fbe,{}),t==="highlight"&&E.jsx(Ibe,{})]}),Nbe=()=>{const[t]=ht(),e=t.masterDocTaxonomyItems.at(t.windowFocusedPage-1),r=(n,i)=>{n.stopPropagation(),window.parent.postMessage({message:{sender:"PdfEditor",query:"handle-taxonomy-item",action:"handle-taxonomy-item",data:{pageItem:i,isAssociate:i==null?void 0:i.Dissociate__c}}},"*")};return E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1em",overflow:"auto"},children:[E.jsx("p",{children:"Page items:"}),E.jsx("div",{className:"hide-scrollbar",style:{display:"flex",gap:"1em",overflow:"auto"},children:e==null?void 0:e.map(n=>{var i,o;return E.jsxs("div",{style:{border:"1px solid #747474",borderRadius:"4px",padding:"4px 2px",display:"flex",alignItems:"center",gap:"4px",maxHeight:"30px",minWidth:"max-content",opacity:n!=null&&n.Dissociate__c?.5:1},children:[E.jsx("p",{style:{color:"#0B5CAB"},children:(o=(i=n==null?void 0:n.ItemType__r)==null?void 0:i.Type__r)==null?void 0:o.Name__c}),E.jsx("p",{onClick:a=>r(a,n),style:{cursor:"pointer"},children:n!=null&&n.Dissociate__c?"+":"X"})]},n.Id)})}),E.jsxs("div",{onClick:()=>{var n;return window.parent.postMessage({message:{sender:"PdfEditor",query:"master-add-taxonomy-item",action:"master-add-taxonomy-item",data:{docId:(n=t==null?void 0:t.sfData.masterDocumentPages)==null?void 0:n.at((t==null?void 0:t.windowFocusedPage)-1),currentItemsIds:e==null?void 0:e.map(i=>i.Id),isMasterDocument:!0}}},"*")},style:{border:"1px solid #747474",borderRadius:"4px",padding:"4px 2px",display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[E.jsx("p",{children:"Add"}),E.jsx("p",{children:"+"})]})]})},Lbe=()=>{const[t]=ht();return E.jsxs("div",{onClick:e=>e.stopPropagation(),style:{boxShadow:"0px 2px 9px 2px rgb(190 190 190)",padding:"0 2em",height:"42px",backgroundColor:"#fff",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"2em",zIndex:100},children:[E.jsxs("div",{style:{width:"auto",display:"flex",gap:"1em",alignItems:"center"},children:[E.jsx(ybe,{}),E.jsx(bbe,{}),E.jsx(xbe,{}),E.jsx(mbe,{}),E.jsx(Sbe,{}),E.jsx(_be,{}),E.jsx(Cbe,{}),(t==null?void 0:t.activeMode)&&E.jsx("div",{style:{width:"1px",backgroundColor:"#747474",height:"70%"}}),(t==null?void 0:t.activeMode)&&E.jsx(Mbe,{active:t.activeMode})]}),t.isMasterDoc&&E.jsx(Nbe,{})]})},Bbe=({width:t="100%",height:e="100%"})=>E.jsx("div",{className:"skeleton",style:{width:t,height:e,background:"#f0f0f0"}}),jbe=()=>{var e;const[t]=ht();return E.jsxs("div",{style:{height:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"auto"},children:[E.jsx(gbe,{}),E.jsx(Lbe,{}),E.jsx("div",{id:"pdf-pages-container",style:{height:"100%",overflow:"auto",paddingTop:"20px",paddingBottom:"30px",width:"100%"},children:(e=t==null?void 0:t.sfData.docListEntry)!=null&&e.Identifier__c?E.jsx(ebe,{}):E.jsx("div",{style:{padding:"1em",width:"100%"},children:E.jsx(Bbe,{})})})]})},Hbe=()=>E.jsxs("div",{style:{width:"100%",flex:"1",backgroundColor:"#939393"},children:[E.jsx(rse,{}),E.jsxs("div",{style:{display:"flex",justifyContent:"space-between",height:"calc(100dvh - 60px)"},children:[E.jsx(jle,{}),E.jsx(jbe,{}),E.jsx($me,{})]})]}),zbe=()=>E.jsx(Hbe,{}),Ube=()=>{const[t,e]=ht();function r(n){var i,o,a,s,l,u,c,f,d,h,p,g,w,b,y,x,C,S,_,A,P,R,T,k,B,j,G,Q,$,z,X,se,ie,Z,te,J,ae,xe,Ae,ve,he;if((i=n==null?void 0:n.data)!=null&&i.message){const fe=n.data.message;console.log("msg",fe);const Me=fe.sender,pt=new Array(50).fill([]);if(Me==="sf"){if(fe.query==="init"){const me=h8((o=fe==null?void 0:fe.data)==null?void 0:o.Annotations),Pe=(me==null?void 0:me.filter(ye=>(ye==null?void 0:ye.Type__c)==="Comment"))??[];let le=Bo(pt);Pe==null||Pe.map(ye=>{ye!=null&&ye.Page__c&&(le[(ye==null?void 0:ye.Page__c)-1]||(le[(ye==null?void 0:ye.Page__c)-1]=[]),le[(ye==null?void 0:ye.Page__c)-1].push(ye))});const Le=((a=me==null?void 0:me.filter(ye=>(ye==null?void 0:ye.Type__c)!=="Comment"))==null?void 0:a.map(ye=>({...ye,PositionX__c:Number(ye==null?void 0:ye.PositionX__c)??0,PositionY__c:Number(ye==null?void 0:ye.PositionY__c)??0})))??[];let ze=Bo(pt);Le==null||Le.map(ye=>{ye!=null&&ye.Page__c&&(ze[(ye==null?void 0:ye.Page__c)-1]||(ze[(ye==null?void 0:ye.Page__c)-1]=[]),ze[(ye==null?void 0:ye.Page__c)-1].push(ye))});const Lt=[];(u=(l=Object==null?void 0:Object.values(((s=fe==null?void 0:fe.data)==null?void 0:s.groupedDocumentListEntryPageItemsByPage)??{}))==null?void 0:l.reduce((ye,Kt)=>[...ye,...Kt],[]))==null||u.map(ye=>{var Te,st;const Kt=(st=(Te=fe==null?void 0:fe.data)==null?void 0:Te.masterDocumentPages)==null?void 0:st.findIndex(nt=>nt.Id===(ye==null?void 0:ye.ParentPage__c));Lt[Kt]||(Lt[Kt]=[]),Lt[Kt].push(ye)}),e(ye=>{var Kt,Te,st,nt,xr;return{...ye,annotations:ze,comments:le,sfData:{...ye==null?void 0:ye.sfData,...fe==null?void 0:fe.data,docListEntry:((Kt=fe==null?void 0:fe.data)==null?void 0:Kt.docListEntry)??{},loggedUser:((Te=fe==null?void 0:fe.data)==null?void 0:Te.loggedUser)??{}},isMasterDoc:(nt=(st=fe==null?void 0:fe.data)==null?void 0:st.docListEntry)==null?void 0:nt.MasterDocument__c,masterDocPages:[(xr=fe==null?void 0:fe.data)==null?void 0:xr.focusedPage],masterDocTaxonomyItems:Lt}});return}if((fe==null?void 0:fe.query)==="annotation-update"){const me=(c=fe==null?void 0:fe.data)==null?void 0:c.annotations,Pe=(d=(f=fe==null?void 0:fe.data)==null?void 0:f.annotations)==null?void 0:d.map(Te=>Te==null?void 0:Te.Parent__c),le=me==null?void 0:me.map(Te=>({...Te,DrawPoints__c:JSON.parse((Te==null?void 0:Te.DrawPoints__c)??"[]"),TextConfig__c:JSON.parse((Te==null?void 0:Te.TextConfig__c)??"{}"),DrawConfig__c:JSON.parse((Te==null?void 0:Te.DrawConfig__c)??"{}"),PositionX__c:Number(Te==null?void 0:Te.PositionX__c)??0,PositionY__c:Number(Te==null?void 0:Te.PositionY__c)??0})),Le=(le==null?void 0:le.filter(Te=>(Te==null?void 0:Te.Type__c)==="Comment"))??[];let ze=(t==null?void 0:t.comments)??[];Le==null||Le.map(Te=>{var nt;const st=(Te==null?void 0:Te.Page__c)-1;(nt=ze[st])==null||nt.unshift(Te)});const Lt=(le==null?void 0:le.filter(Te=>(Te==null?void 0:Te.Type__c)!=="Comment"))??[];let ye=(t==null?void 0:t.annotations)??[];Lt==null||Lt.map(Te=>{var nt;const st=(Te==null?void 0:Te.Page__c)-1;(nt=ye[st])==null||nt.unshift(Te)}),ye=ye==null?void 0:ye.map(Te=>d3(Te,st=>st==null?void 0:st.Id).filter(st=>!(Pe!=null&&Pe.includes(st.Id)))),ze=ze==null?void 0:ze.map(Te=>{var st;return(st=d3(Te,nt=>nt==null?void 0:nt.Id))==null?void 0:st.filter(nt=>!(Pe!=null&&Pe.includes(nt.Id)))});const Kt=((h=t==null?void 0:t.selectedAnnotation)==null?void 0:h.Id)===((p=me==null?void 0:me.at(0))==null?void 0:p.Id)?{...me==null?void 0:me.at(0),Content__c:(g=t==null?void 0:t.selectedAnnotation)==null?void 0:g.Content__c,DrawPoints__c:JSON.parse(((w=me==null?void 0:me.at(0))==null?void 0:w.DrawPoints__c)??"[]"),TextConfig__c:JSON.parse(((b=me==null?void 0:me.at(0))==null?void 0:b.TextConfig__c)??"{}"),DrawConfig__c:JSON.parse(((y=me==null?void 0:me.at(0))==null?void 0:y.DrawConfig__c)??"{}")}:t==null?void 0:t.selectedAnnotation;e(Te=>({...Te,annotations:ye??pt,comments:ze??pt,repaintAnnotations:Math.random(),selectedAnnotation:Kt}))}if((fe==null?void 0:fe.query)==="annotation-delete"){const me=(x=fe==null?void 0:fe.data)==null?void 0:x.annotations,Pe=(t==null?void 0:t.annotations)??[],le=(t==null?void 0:t.comments)??[];Pe==null||Pe.map((Le,ze)=>{Pe[ze]=Le.filter(Lt=>!me.includes(Lt.Id))}),le==null||le.map((Le,ze)=>{le[ze]=Le.filter(Lt=>!me.includes(Lt.Id))}),e(Le=>({...Le,annotations:Pe??pt,comments:le??pt,repaintAnnotations:Math.random(),selectedAnnotation:{}}))}if((fe==null?void 0:fe.query)==="annotation-create"){let me;const Pe=((S=(C=fe==null?void 0:fe.data)==null?void 0:C.annotation)==null?void 0:S.Type__c)!=="Comment";if(Pe?me=[...(t==null?void 0:t.annotations)??[]]:me=[...(t==null?void 0:t.comments)??[]],!((A=(_=fe==null?void 0:fe.data)==null?void 0:_.annotation)!=null&&A.Page__c))return;const le=((R=(P=fe==null?void 0:fe.data)==null?void 0:P.annotation)==null?void 0:R.Page__c)-1;(Array==null?void 0:Array.isArray(me[le]))===!1&&(me[le]=[]),me[le].unshift({...(T=fe==null?void 0:fe.data)==null?void 0:T.annotation,DrawPoints__c:JSON.parse(((B=(k=fe==null?void 0:fe.data)==null?void 0:k.annotation)==null?void 0:B.DrawPoints__c)??"[]"),TextConfig__c:JSON.parse(((G=(j=fe==null?void 0:fe.data)==null?void 0:j.annotation)==null?void 0:G.TextConfig__c)??"{}"),DrawConfig__c:JSON.parse((($=(Q=fe==null?void 0:fe.data)==null?void 0:Q.annotation)==null?void 0:$.DrawConfig__c)??"{}"),PositionX__c:Number((X=(z=fe==null?void 0:fe.data)==null?void 0:z.annotation)==null?void 0:X.PositionX__c)??0,PositionY__c:Number((ie=(se=fe==null?void 0:fe.data)==null?void 0:se.annotation)==null?void 0:ie.PositionY__c)??0}),me[le]=(Z=me[le])==null?void 0:Z.filter(Le=>{var ze;return!((ze=Le==null?void 0:Le.Id)!=null&&ze.startsWith("FAKE"))}),e(Le=>({...Le,...Pe?{annotations:me}:{comments:me},lockPdf:!1,createAnnotation:{}}))}if(fe.action==="newVersionSaved"){const me=Bo(pt),Pe=Bo(pt);(J=(te=fe==null?void 0:fe.data)==null?void 0:te.annotations)==null||J.map(le=>{var Le,ze;le!=null&&le.Page__c&&((le==null?void 0:le.Type__c)==="Comment"?(Pe[(le==null?void 0:le.Page__c)-1]||(Pe[(le==null?void 0:le.Page__c)-1]=[]),(Le=Pe[(le==null?void 0:le.Page__c)-1])==null||Le.push(le)):(me[(le==null?void 0:le.Page__c)-1]||(me[(le==null?void 0:le.Page__c)-1]=[]),(ze=me[(le==null?void 0:le.Page__c)-1])==null||ze.push(le)))}),e(le=>({...le,annotations:me==null?void 0:me.map(Le=>h8(Le)),comments:Pe==null?void 0:Pe.map(Le=>h8(Le)),repaintAnnotations:Math==null?void 0:Math.random(),selectedAnnotation:{},saveSuccess:Math==null?void 0:Math.random()}))}if(fe.query==="master-page-focus"){const me=(xe=(ae=fe==null?void 0:fe.data)==null?void 0:ae.focusedPage)==null?void 0:xe.page,Pe=t==null?void 0:t.masterDocPages;Pe[me]=(Ae=fe.data)==null?void 0:Ae.focusedPage}if((fe==null?void 0:fe.query)==="master-save-finish"){const me=(he=(ve=t==null?void 0:t.sfData)==null?void 0:ve.docListEntry)==null?void 0:he.Identifier__c;setTimeout(()=>{e(Pe=>{var le;return{...Pe,sfData:{...Pe==null?void 0:Pe.sfData,docListEntry:{...(le=Pe==null?void 0:Pe.sfData)==null?void 0:le.docListEntry,Identifier__c:null}}}})},1e3),setTimeout(()=>{e(Pe=>{var le;return{...Pe,sfData:{...Pe.sfData,docListEntry:{...(le=Pe.sfData)==null?void 0:le.docListEntry,Identifier__c:me}},savingMasterDoc:!1,lockPdf:!1}})},4e3)}fe.query==="master-page-single"&&e(me=>{var Pe,le;return{...me,documentPagesByDocId:{...me==null?void 0:me.documentPagesByDocId,[(Pe=fe==null?void 0:fe.data)==null?void 0:Pe.doclistEntryId]:{pages:((le=fe==null?void 0:fe.data)==null?void 0:le.pages)??[],taxonomy:fe.data.groupedDocumentListEntryPageItemsByPage??[]}}}})}}}return q.useEffect(()=>(window.addEventListener("message",r),()=>{window.removeEventListener("message",r)}),[e,t]),console.log(t,"ctx"),E.jsx(E.Fragment,{})};function h8(t){return!t||(t==null?void 0:t.length)===0?[]:t==null?void 0:t.map(e=>({...e,DrawPoints__c:JSON.parse((e==null?void 0:e.DrawPoints__c)??"[]"),TextConfig__c:JSON.parse((e==null?void 0:e.TextConfig__c)??"{}"),DrawConfig__c:JSON.parse((e==null?void 0:e.DrawConfig__c)??"{}")}))}class DH extends q.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){this.setState({hasError:!0,error:e,info:r})}render(){var e,r,n;return this.state.hasError?E.jsxs(E.Fragment,{children:[E.jsx("p",{children:"Error"}),E.jsx("p",{children:"Something went wrong."}),E.jsx("p",{children:(r=(e=this==null?void 0:this.state)==null?void 0:e.error)==null?void 0:r.toString()}),E.jsx("p",{children:JSON.stringify((n=this==null?void 0:this.state)==null?void 0:n.info)})]}):this.props.children}}oq.workerSrc="/resource/1720544294000/TL_PDF_Editor/pdf.worker.js";function Vbe(){return q.useEffect(()=>{setTimeout(()=>{window.parent.postMessage({message:{sender:"PdfEditor",query:"mountedComponent"}},"*")},1e3)},[]),E.jsxs("div",{style:{height:"100vh",width:"100vw",display:"flex",alignItems:"center",flexDirection:"column"},children:[E.jsx(zbe,{}),E.jsx(Ube,{})]})}const Wbe=()=>E.jsx(aq,{children:E.jsx(sC,{iconPath:"",children:E.jsx(DH,{children:E.jsx(Vbe,{})})})}),qbe=document.getElementById("pdfRoot");qbe!==null&&p8.createRoot(document.getElementById("pdfRoot")).render(E.jsx(F.StrictMode,{children:E.jsx(DH,{children:E.jsx(Wbe,{})})}));


ðŸ“ž API PATTERNS:
  â€¢ UE
  â€¢ OFF
  â€¢ BitsPerCoordinate
  â€¢ initial - pdf load
  â€¢ ZapfDingbats

ðŸ”‘ KEY FILE ANALYSIS:

ðŸ“„ index.html (1218856 chars)
Content preview:
  <!DOCTYPE html>
  <html lang="en">
    <head>
      <meta charset="UTF-8" />
      <link rel="icon" type="image/svg+xml" href="/resource/1720544294000/TL_PDF_Editor/vite.svg" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Vite PDF Editor</title>
      <style>
        @charset "UTF-8"; /*! Lightning Design System 2.24.5 */
        :root {
          --slds-g-color-neutral-base-100: #ffffff;
          --slds-g-color-neutral-base-95: #f3f3f3;
          --slds-g-color-neutral-base-90: #e5e5e5;
          --slds-g-color-neutral-base-80: #c9c9c9;
          --slds-g-color-neutral-base-70: #aeaeae;
  ... (truncated)

ðŸ–¼ï¸ IFRAME ACCESS TESTS: 4 tested, 4 successful
âœ… SUCCESSFUL IFRAME ACCESS:
  â€¢ https://incitetax.my.salesforce.com/resource/1748037284000/TL_PDF_Editor/index.html
    Type: text/html; charset=UTF-8
    Preview:



      <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
      <html>
      <head>
          <meta HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">




  â€¢ https://incitetax.my.salesforce.com/resource/TL_PDF_Editor/index.html
    Type: text/html; charset=UTF-8
    Preview:



      <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
      <html>
      <head>
          <meta HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">




  â€¢ https://incitetax.my.salesforce.com/resource/1748037284000/TL_PDF_Editor
    Type: text/html; charset=UTF-8
    Preview:



      <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
      <html>
      <head>
          <meta HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">




  â€¢ https://incitetax.my.salesforce.com/resource/TL_PDF_Editor
    Type: text/html; charset=UTF-8
    Preview:



      <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
      <html>
      <head>
          <meta HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">





================================================================================
ðŸŽ¯ FINAL ANALYSIS - S3 ACCESS MECHANISM
================================================================================
ðŸ”¥ BREAKTHROUGHS ACHIEVED:
âœ… Successfully extracted PDF viewer source code
ðŸŒ Found 2 S3-related patterns in source
ðŸ“ž Found 522 API endpoints in source
ðŸ” Found 6 authentication patterns
ðŸ“„ Successfully accessed 4 iframe URLs

ðŸ’¡ NEXT STEPS:
1. Analyze extracted JavaScript for exact S3 access method
2. Look for authentication tokens or session handling
3. Find URL construction logic for S3 file access
4. Implement discovered method in Python backup script
================================================================================
(incite_venv) PS C:\Users\lunaf\Desktop\Projects\simplyautomate\incite_migration_script>